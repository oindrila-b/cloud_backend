{"version":3,"sources":["webpack://OktaAuth/webpack/universalModuleDefinition","webpack://OktaAuth/webpack/bootstrap","webpack://OktaAuth/./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack://OktaAuth/./node_modules/@babel/runtime/regenerator/index.js","webpack://OktaAuth/./node_modules/@babel/runtime/helpers/assertThisInitialized.js","webpack://OktaAuth/./node_modules/@babel/runtime/helpers/getPrototypeOf.js","webpack://OktaAuth/./node_modules/@babel/runtime/helpers/createClass.js","webpack://OktaAuth/./node_modules/@babel/runtime/helpers/inherits.js","webpack://OktaAuth/./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","webpack://OktaAuth/./node_modules/@babel/runtime/helpers/typeof.js","webpack://OktaAuth/./node_modules/@babel/runtime/helpers/defineProperty.js","webpack://OktaAuth/./node_modules/@babel/runtime/helpers/setPrototypeOf.js","webpack://OktaAuth/./node_modules/@babel/runtime/helpers/wrapNativeSuper.js","webpack://OktaAuth/./lib/fetch/fetchRequest.ts","webpack://OktaAuth/./node_modules/cross-fetch/dist/browser-ponyfill.js","webpack://OktaAuth/./node_modules/@babel/runtime/helpers/slicedToArray.js","webpack://OktaAuth/./node_modules/regenerator-runtime/runtime.js","webpack://OktaAuth/./node_modules/@babel/runtime/helpers/isNativeFunction.js","webpack://OktaAuth/./node_modules/@babel/runtime/helpers/construct.js","webpack://OktaAuth/./node_modules/@babel/runtime/helpers/isNativeReflectConstruct.js","webpack://OktaAuth/(webpack)/buildin/global.js","webpack://OktaAuth/./node_modules/js-cookie/src/js.cookie.js","webpack://OktaAuth/./node_modules/@babel/runtime/helpers/arrayWithHoles.js","webpack://OktaAuth/./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","webpack://OktaAuth/./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","webpack://OktaAuth/./node_modules/@babel/runtime/helpers/arrayLikeToArray.js","webpack://OktaAuth/./node_modules/@babel/runtime/helpers/nonIterableRest.js","webpack://OktaAuth/./node_modules/p-cancelable/index.js","webpack://OktaAuth/./node_modules/tiny-emitter/index.js","webpack://OktaAuth/./lib/errors/CustomError.ts","webpack://OktaAuth/./lib/errors/AuthSdkError.ts","webpack://OktaAuth/./lib/builderUtil.ts","webpack://OktaAuth/./lib/util.ts","webpack://OktaAuth/./lib/errors/AuthApiError.ts","webpack://OktaAuth/./lib/constants.ts","webpack://OktaAuth/./lib/http.ts","webpack://OktaAuth/./lib/tx/util.ts","webpack://OktaAuth/./lib/errors/AuthPollStopError.ts","webpack://OktaAuth/./lib/tx/poll.ts","webpack://OktaAuth/./lib/tx/AuthTransaction.ts","webpack://OktaAuth/./lib/tx/api.ts","webpack://OktaAuth/./lib/tx/TransactionState.ts","webpack://OktaAuth/./lib/oidc/util/pkce.ts","webpack://OktaAuth/./lib/SavedObject.ts","webpack://OktaAuth/./lib/StorageManager.ts","webpack://OktaAuth/./lib/errors/OAuthError.ts","webpack://OktaAuth/./lib/types/Transaction.ts","webpack://OktaAuth/./lib/types/Token.ts","webpack://OktaAuth/./lib/TransactionManager.ts","webpack://OktaAuth/./lib/OktaAuthBase.ts","webpack://OktaAuth/./lib/browser/features.ts","webpack://OktaAuth/./lib/browser/browserStorage.ts","webpack://OktaAuth/./lib/session.ts","webpack://OktaAuth/./lib/oidc/endpoints/authorize.ts","webpack://OktaAuth/./lib/oidc/endpoints/token.ts","webpack://OktaAuth/./lib/oidc/endpoints/well-known.ts","webpack://OktaAuth/./lib/oidc/util/browser.ts","webpack://OktaAuth/./lib/oidc/util/oauth.ts","webpack://OktaAuth/./lib/oidc/util/defaultTokenParams.ts","webpack://OktaAuth/./lib/oidc/util/errors.ts","webpack://OktaAuth/./lib/oidc/util/loginRedirect.ts","webpack://OktaAuth/./lib/oidc/util/prepareTokenParams.ts","webpack://OktaAuth/./lib/oidc/util/urlParams.ts","webpack://OktaAuth/./lib/oidc/util/validateClaims.ts","webpack://OktaAuth/./lib/oidc/decodeToken.ts","webpack://OktaAuth/./lib/oidc/revokeToken.ts","webpack://OktaAuth/./lib/oidc/exchangeCodeForTokens.ts","webpack://OktaAuth/./lib/crypto.ts","webpack://OktaAuth/./lib/oidc/verifyToken.ts","webpack://OktaAuth/./lib/oidc/handleOAuthResponse.ts","webpack://OktaAuth/./lib/oidc/getToken.ts","webpack://OktaAuth/./lib/oidc/getWithoutPrompt.ts","webpack://OktaAuth/./lib/oidc/renewToken.ts","webpack://OktaAuth/./lib/oidc/renewTokensWithRefresh.ts","webpack://OktaAuth/./lib/oidc/renewTokens.ts","webpack://OktaAuth/./lib/oidc/getUserInfo.ts","webpack://OktaAuth/./lib/oidc/getWithPopup.ts","webpack://OktaAuth/./lib/oidc/getWithRedirect.ts","webpack://OktaAuth/./lib/oidc/parseFromUrl.ts","webpack://OktaAuth/./lib/clock.ts","webpack://OktaAuth/./lib/TokenManager.ts","webpack://OktaAuth/./lib/PromiseQueue.ts","webpack://OktaAuth/./lib/browser/fingerprint.ts","webpack://OktaAuth/./lib/AuthStateManager.ts","webpack://OktaAuth/./lib/browser/browser.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","instance","Constructor","TypeError","self","ReferenceError","_getPrototypeOf","setPrototypeOf","getPrototypeOf","__proto__","_defineProperties","target","props","length","descriptor","configurable","writable","protoProps","staticProps","subClass","superClass","constructor","_typeof","assertThisInitialized","obj","iterator","_setPrototypeOf","isNativeFunction","construct","_wrapNativeSuper","Class","_cache","Map","undefined","has","set","Wrapper","arguments","this","fetchRequest","method","url","args","body","data","headers","JSON","stringify","fetchPromise","global","fetch","crossFetch","credentials","withCredentials","finally","Promise","resolve","then","response","error","ok","status","toLowerCase","indexOf","json","catch","e","errorSummary","text","readData","isObject","result","responseText","responseType","responseJSON","formatResult","__self__","F","DOMException","support","Blob","viewClasses","isArrayBufferView","ArrayBuffer","isView","toString","normalizeName","String","test","normalizeValue","iteratorFor","items","next","shift","done","Headers","map","forEach","append","Array","isArray","header","getOwnPropertyNames","consumed","bodyUsed","reject","fileReaderReady","reader","onload","onerror","readBlobAsArrayBuffer","blob","FileReader","promise","readAsArrayBuffer","bufferClone","buf","slice","view","Uint8Array","byteLength","buffer","Body","_initBody","_bodyInit","_bodyText","isPrototypeOf","_bodyBlob","FormData","_bodyFormData","URLSearchParams","DataView","_bodyArrayBuffer","type","rejected","Error","arrayBuffer","readAsText","chars","fromCharCode","join","readArrayBufferAsText","formData","decode","parse","oldValue","callback","thisArg","keys","push","values","entries","methods","Request","input","options","upcased","signal","toUpperCase","referrer","form","trim","split","bytes","replace","decodeURIComponent","Response","bodyInit","statusText","clone","redirectStatuses","redirect","RangeError","location","err","message","stack","init","request","aborted","xhr","XMLHttpRequest","abortXhr","abort","rawHeaders","getAllResponseHeaders","line","parts","responseURL","ontimeout","onabort","open","setRequestHeader","addEventListener","onreadystatechange","readyState","removeEventListener","send","polyfill","default","arrayWithHoles","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","arr","runtime","Op","hasOwn","$Symbol","iteratorSymbol","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","generator","context","Context","_invoke","state","arg","doneResult","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","makeInvokeMethod","fn","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","NativeIteratorPrototype","Gp","defineIteratorMethods","AsyncIterator","PromiseImpl","previousPromise","callInvokeWithMethodAndArg","invoke","__await","unwrapped","info","resultName","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","displayName","isGeneratorFunction","genFun","ctor","mark","awrap","async","iter","reverse","pop","skipTempReset","prev","charAt","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","regeneratorRuntime","accidentalStrictMode","Function","isNativeReflectConstruct","_construct","Parent","Reflect","a","apply","sham","Proxy","Date","g","OldCookies","Cookies","api","noConflict","extend","attributes","converter","document","path","defaults","expires","toUTCString","write","encodeURIComponent","escape","stringifiedAttributes","attributeName","cookie","jar","cookies","read","getJSON","remove","withConverter","_arr","_n","_d","_e","_s","_i","arrayLikeToArray","minLen","from","len","arr2","CancelError","reason","PCancelable","executor","_cancelHandlers","_isPending","_isCanceled","_rejectOnCancel","_promise","_reject","onCancel","handler","defineProperties","shouldReject","boolean","userFn","arguments_","onFulfilled","onRejected","onFinally","E","on","ctx","once","listener","off","_","emit","evtArr","evts","liveEvents","CustomError","AuthSdkError","msg","errorCode","errorLink","errorId","errorCauses","getUserAgent","sdkValue","userAgent","template","stringToBase64Url","str","base64ToBase64Url","btoa","b64","base64UrlToBase64","b64u","base64UrlToString","utf8","atob","stringToBuffer","charCodeAt","base64UrlDecode","additionalArgs","concat","isAbsoluteUrl","toAbsoluteUrl","baseUrl","removeTrailingSlash","toRelativeUrl","substring","isString","isNumber","isoToUTCString","match","isoTime","UTC","toQueryString","genRandomString","randomCharset","random","cl","Math","floor","obj1","objArray","prop","removeNils","cleaned","omit","newobj","find","collection","searchParams","item","found","getLink","linkName","altName","_links","link","getNativeConsole","console","getConsole","nativeConsole","log","warn","group","groupEnd","deprecate","deprecateWrap","trimmed","isIE11OrLess","documentMode","isFunction","delay","ms","setTimeout","isPromise","AuthApiError","STATE_TOKEN_KEY_NAME","DEFAULT_POLLING_DELAY","DEFAULT_MAX_CLOCK_SKEW","DEFAULT_CACHE_DURATION","REDIRECT_OAUTH_PARAMS_NAME","REDIRECT_STATE_COOKIE_NAME","REDIRECT_NONCE_COOKIE_NAME","TOKEN_STORAGE_NAME","CACHE_STORAGE_NAME","PKCE_STORAGE_NAME","TRANSACTION_STORAGE_NAME","ACCESS_TOKEN_STORAGE_KEY","ID_TOKEN_STORAGE_KEY","REFRESH_TOKEN_STORAGE_KEY","REFERRER_PATH_STORAGE_KEY","MIN_VERIFIER_LENGTH","MAX_VERIFIER_LENGTH","DEFAULT_CODE_CHALLENGE_METHOD","httpRequest","sdk","saveAuthnState","accessToken","storage","storageUtil","httpCache","storageManager","getHttpCache","cacheResponse","cachedResponse","getStorage","now","expiresAt","assign","res","ajaxOptions","httpRequestClient","resp","stateToken","delete","updateStorage","serverErr","transformErrorXHR","getOptions","getIssuerOrigin","post","postOptions","addStateToken","builtArgs","getStateToken","AuthPollStopError","getPollFn","ref","rememberDevice","autoPush","transactionCallBack","pollLink","isPolling","retryCount","recursivePoll","opts","href","http","pollFn","pollRes","factorResult","delayFn","AuthTransaction","delayLength","pow","flattenEmbedded","cancel","link2fn","lk","hints","allow","factorType","provider","params","profile","updatePhone","postToTransaction","objArr","ol","embedded","_embedded","fns","poll","links2fns","transactionStatus","resumeTransaction","tx","exists","_get","introspect","transactionStep","transactionExists","TransactionState","dec2hex","dec","substr","generateVerifier","prefix","verifier","ceil","crypto","getRandomValues","computeChallenge","TextEncoder","encode","subtle","digest","SavedObject","storageName","storageProvider","clearStorage","storageString","getItem","setItem","setStorage","removeItem","StorageManager","storageManagerOptions","cookieOptions","sectionName","overrideOptions","storageType","storageTypes","idx","findStorageType","getStorageByType","getOptionsForSection","storageKey","OAuthError","summary","isObjectWithProperties","isOAuthTransactionMeta","redirectUri","isPKCETransactionMeta","codeVerifier","isIdxTransactionMeta","interactionHandle","isCustomAuthTransactionMeta","isTransactionMeta","isToken","idToken","refreshToken","scopes","isAccessToken","isIDToken","isRefreshToken","TransactionManager","legacyWidgetSupport","saveNonceCookie","saveStateCookie","saveParamsCookie","getTransactionStorage","oauth","clearLegacyOAuthParams","pkce","clearLegacyPKCE","meta","cookieStorage","nonce","clientId","urls","ignoreSignature","oauthParams","load","_a","loadLegacyOAuthParams","pkceMeta","loadLegacyPKCE","testStorageType","getLegacyPKCEStorage","getLegacyOAuthParamsStorage","OktaAuthBase","issuer","RegExp","assertValidConfig","tokenUrl","authorizeUrl","userinfoUrl","revokeUrl","logoutUrl","postLogoutRedirectUri","responseMode","transformAuthState","restoreOriginalUri","devMode","token","transaction","transactionManager","resume","PKCE","isWindowsPhone","navigator","isFingerprintSupported","agent","isPopupPostMessageSupported","isIE8or9","postMessage","isTokenVerifySupported","hasTextEncoder","isPKCESupported","isHTTPS","protocol","isLocalhost","hostname","require","getPKCEStorage","browserHasLocalStorage","getLocalStorage","testStorage","browserHasSessionStorage","getSessionStorage","supported","getCookieStorage","getInMemoryStorage","types","curType","nextType","localStorage","sessionStorage","secure","sameSite","useMultipleCookies","k","existingValues","valueToStore","store","sessionExists","session","getSession","refresh","user","closeSession","refreshSession","setCookieAndRedirect","sessionToken","redirectUrl","checkAccountSetupComplete","convertTokenParamsToOAuthParams","tokenParams","codeChallenge","codeChallengeMethod","display","idp","idpScope","loginHint","maxAge","prompt","mayBeArray","scope","buildAuthorizeParams","postToTokenEndpoint","authorizationCode","interactionCode","validateOptions","code","getPostData","postRefreshToken","client_id","grant_type","refresh_token","getWellKnown","authServerUri","getKey","kid","wellKnown","jwksUri","cachedKey","addListener","eventTarget","attachEvent","removeListener","detachEvent","loadFrame","src","iframe","createElement","style","appendChild","loadPopup","title","popupTitle","appearance","winEl","addPostMessageListener","timeout","responseHandler","timeoutId","origin","clearTimeout","generateState","generateNonce","getOAuthUrls","getDefaultTokenParams","isInteractionRequiredError","isAuthorizationCodeError","errorResponse","hasTokensInHash","hash","hasAuthorizationCode","hashOrSearch","hasInteractionCode","hasErrorInUrl","isRedirectUri","uri","authParams","isCodeFlow","getHashOrSearch","search","isLoginRedirect","codeFlow","isInteractionRequired","prepareTokenParams","features","errorMessage","clonedParams","urlParamsToObject","plus2space","paramSplit","fragment","param","exec","validateClaims","claims","validationParams","aud","iss","iat","exp","maxClockSkew","decodeToken","decodedToken","jwt","payload","signature","revokeToken","token_type_hint","creds","exchangeCodeForTokens","handleOAuthResponse","verifyToken","algo","use","importKey","cryptoKey","verify","__awaiter","_arguments","P","fulfilled","step","openIdConfig","validationOptions","sdkCrypto","at_hash","firstHalf","interaction_code","validateResponse","tokenDict","expiresIn","expires_in","tokenType","token_type","access_token","id_token","accessJwt","Number","idJwt","idTokenObj","tokens","getToken","requestUrl","iframePromise","iframeEl","contains","parentElement","removeChild","oauthPromise","windowEl","closePoller","setInterval","closed","clearInterval","close","getWithoutPrompt","renewToken","renewTokensWithRefresh","refreshTokenObject","renewTokenParams","tokenResponse","renewTokens","tokenManager","getTokens","getUserInfo","accessTokenObject","idTokenObject","userInfo","sub","authenticateHeader","getResponseHeader","errorMatches","errorDescriptionMatches","errorDescription","getWithPopup","getWithRedirect","oauthMeta","save","_setLocation","parseFromUrl","paramStr","defaultResponseMode","nativeLoc","_getLocation","nativeHistory","_getHistory","nativeDoc","_getDocument","replaceState","pathname","removeSearch","removeHash","clear","SdkClock","localOffset","parseInt","DEFAULT_OPTIONS","autoRenew","autoRemove","expireEarlySeconds","_storageEventDelay","EVENT_EXPIRED","EVENT_RENEWED","EVENT_ADDED","EVENT_REMOVED","EVENT_ERROR","getExpireTime","tokenMgmtRef","hasExpired","clock","emitAdded","emitter","emitRemoved","emitError","emitEventsForCrossTabsStorageUpdate","newValue","oldTokens","getTokensFromStorageValue","newTokens","oldToken","newToken","clearExpireEventTimeout","expireTimeouts","renewPromise","clearExpireEventTimeoutAll","setExpireEventTimeout","expireTime","expireEventWait","max","expireEventTimeout","emitExpired","setExpireEventTimeoutAll","tokenStorage","resetExpireEventTimeoutAll","validateToken","_add","add","getKeyByType","filter","getAsync","getTokensAsync","setTokens","accessTokenCb","idTokenCb","refreshTokenCb","handleAdded","tokenCb","handleRemoved","idTokenKey","accessTokenKey","refreshTokenKey","existingTokens","removedToken","_renewToken","freshTokens","renew","existingPromise","freshToken","oldTokenStorage","emitRenewed","currentToken","tokenKey","TokenManager","storageOptions","getTokenStorage","_getStorageKeyByType","_clearExpireEventTimeoutAll","_getOptions","_resetExpireEventTimeoutAll","_emitEventsForCrossTabsStorageUpdate","renewTimeQueue","firstTime","shouldThrottleRenew","PromiseQueue","queue","running","thisObject","run","queueItem","fingerprint","source","DEFAULT_AUTH_STATE","isPending","isAuthenticated","DEFAULT_PENDING","updateAuthStatePromise","canceledTimes","AuthStateManager","_sdk","_pending","_authState","_logOptions","_setLogOptions","event","updateAuthState","emitAuthStateChange","authState","prevState","shouldEvaluateIsPending","cancelablePromise","emitAndResolve","isCanceled","__rest","getOwnPropertySymbols","propertyIsEnumerable","Emitter","getCookieSettings","cookieSettings","OktaAuthBrowser","browserStorage","cache","handleLogin","SDK_VERSION","_tokenQueue","revoke","syncMethods","history","authStateManager","signInWithCredentials","_postToTransaction","sendFingerprint","originalUri","additionalParams","setOriginalUri","defaultUri","currentUri","revokeAccessToken","revokeRefreshToken","reload","idTokenHint","logoutUri","getAuthState","unsubscribe","subscribe","handleRedirect","getOriginalUri","removeOriginalUri","storeTokensFromRedirect","hasResponseType","constants"],"mappings":"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","file":"okta-auth-js.umd.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"OktaAuth\"] = factory();\n\telse\n\t\troot[\"OktaAuth\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 27);\n","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","module.exports = require(\"regenerator-runtime\");\n","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;","var _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nvar assertThisInitialized = require(\"./assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","var getPrototypeOf = require(\"./getPrototypeOf\");\n\nvar setPrototypeOf = require(\"./setPrototypeOf\");\n\nvar isNativeFunction = require(\"./isNativeFunction\");\n\nvar construct = require(\"./construct\");\n\nfunction _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  module.exports = _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return construct(Class, arguments, getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}\n\nmodule.exports = _wrapNativeSuper;","/*!\n * Copyright (c) 2018-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nimport crossFetch from 'cross-fetch';\nfunction readData(response) {\n    if (response.headers.get('Content-Type') &&\n        response.headers.get('Content-Type').toLowerCase().indexOf('application/json') >= 0) {\n        return response.json()\n            // JSON parse can fail if response is not a valid object\n            .catch(e => {\n            return {\n                error: e,\n                errorSummary: 'Could not parse server response'\n            };\n        });\n    }\n    else {\n        return response.text();\n    }\n}\nfunction formatResult(status, data) {\n    const isObject = typeof data === 'object';\n    const result = {\n        responseText: isObject ? JSON.stringify(data) : data,\n        status: status\n    };\n    if (isObject) {\n        result.responseType = 'json';\n        result.responseJSON = data;\n    }\n    return result;\n}\n/* eslint-disable complexity */\nfunction fetchRequest(method, url, args) {\n    var body = args.data;\n    var headers = args.headers || {};\n    var contentType = (headers['Content-Type'] || headers['content-type'] || '');\n    // JSON encode body (if appropriate)\n    if (contentType === 'application/json' && body && typeof body !== 'string') {\n        body = JSON.stringify(body);\n    }\n    var fetch = global.fetch || crossFetch;\n    var fetchPromise = fetch(url, {\n        method: method,\n        headers: args.headers,\n        body: body,\n        credentials: args.withCredentials ? 'include' : 'omit'\n    });\n    if (!fetchPromise.finally) {\n        fetchPromise = Promise.resolve(fetchPromise);\n    }\n    return fetchPromise.then(function (response) {\n        var error = !response.ok;\n        var status = response.status;\n        return readData(response)\n            .then(data => {\n            return formatResult(status, data);\n        })\n            .then(result => {\n            if (error) {\n                // Throwing result object since error handling is done in http.js\n                throw result;\n            }\n            return result;\n        });\n    });\n}\nexport default fetchRequest;\n","var __self__ = (function (root) {\nfunction F() {\nthis.fetch = false;\nthis.DOMException = root.DOMException\n}\nF.prototype = root;\nreturn new F();\n})(typeof self !== 'undefined' ? self : this);\n(function(self) {\n\nvar irrelevant = (function (exports) {\n\n  var support = {\n    searchParams: 'URLSearchParams' in self,\n    iterable: 'Symbol' in self && 'iterator' in Symbol,\n    blob:\n      'FileReader' in self &&\n      'Blob' in self &&\n      (function() {\n        try {\n          new Blob();\n          return true\n        } catch (e) {\n          return false\n        }\n      })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  };\n\n  function isDataView(obj) {\n    return obj && DataView.prototype.isPrototypeOf(obj)\n  }\n\n  if (support.arrayBuffer) {\n    var viewClasses = [\n      '[object Int8Array]',\n      '[object Uint8Array]',\n      '[object Uint8ClampedArray]',\n      '[object Int16Array]',\n      '[object Uint16Array]',\n      '[object Int32Array]',\n      '[object Uint32Array]',\n      '[object Float32Array]',\n      '[object Float64Array]'\n    ];\n\n    var isArrayBufferView =\n      ArrayBuffer.isView ||\n      function(obj) {\n        return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n      };\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name);\n    }\n    if (/[^a-z0-9\\-#$%&'*+.^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value);\n    }\n    return value\n  }\n\n  // Build a destructive iterator for the value list\n  function iteratorFor(items) {\n    var iterator = {\n      next: function() {\n        var value = items.shift();\n        return {done: value === undefined, value: value}\n      }\n    };\n\n    if (support.iterable) {\n      iterator[Symbol.iterator] = function() {\n        return iterator\n      };\n    }\n\n    return iterator\n  }\n\n  function Headers(headers) {\n    this.map = {};\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value);\n      }, this);\n    } else if (Array.isArray(headers)) {\n      headers.forEach(function(header) {\n        this.append(header[0], header[1]);\n      }, this);\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name]);\n      }, this);\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name);\n    value = normalizeValue(value);\n    var oldValue = this.map[name];\n    this.map[name] = oldValue ? oldValue + ', ' + value : value;\n  };\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)];\n  };\n\n  Headers.prototype.get = function(name) {\n    name = normalizeName(name);\n    return this.has(name) ? this.map[name] : null\n  };\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  };\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = normalizeValue(value);\n  };\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    for (var name in this.map) {\n      if (this.map.hasOwnProperty(name)) {\n        callback.call(thisArg, this.map[name], name, this);\n      }\n    }\n  };\n\n  Headers.prototype.keys = function() {\n    var items = [];\n    this.forEach(function(value, name) {\n      items.push(name);\n    });\n    return iteratorFor(items)\n  };\n\n  Headers.prototype.values = function() {\n    var items = [];\n    this.forEach(function(value) {\n      items.push(value);\n    });\n    return iteratorFor(items)\n  };\n\n  Headers.prototype.entries = function() {\n    var items = [];\n    this.forEach(function(value, name) {\n      items.push([name, value]);\n    });\n    return iteratorFor(items)\n  };\n\n  if (support.iterable) {\n    Headers.prototype[Symbol.iterator] = Headers.prototype.entries;\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true;\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result);\n      };\n      reader.onerror = function() {\n        reject(reader.error);\n      };\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader();\n    var promise = fileReaderReady(reader);\n    reader.readAsArrayBuffer(blob);\n    return promise\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader();\n    var promise = fileReaderReady(reader);\n    reader.readAsText(blob);\n    return promise\n  }\n\n  function readArrayBufferAsText(buf) {\n    var view = new Uint8Array(buf);\n    var chars = new Array(view.length);\n\n    for (var i = 0; i < view.length; i++) {\n      chars[i] = String.fromCharCode(view[i]);\n    }\n    return chars.join('')\n  }\n\n  function bufferClone(buf) {\n    if (buf.slice) {\n      return buf.slice(0)\n    } else {\n      var view = new Uint8Array(buf.byteLength);\n      view.set(new Uint8Array(buf));\n      return view.buffer\n    }\n  }\n\n  function Body() {\n    this.bodyUsed = false;\n\n    this._initBody = function(body) {\n      this._bodyInit = body;\n      if (!body) {\n        this._bodyText = '';\n      } else if (typeof body === 'string') {\n        this._bodyText = body;\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body;\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body;\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this._bodyText = body.toString();\n      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n        this._bodyArrayBuffer = bufferClone(body.buffer);\n        // IE 10-11 can't handle a DataView body.\n        this._bodyInit = new Blob([this._bodyArrayBuffer]);\n      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n        this._bodyArrayBuffer = bufferClone(body);\n      } else {\n        this._bodyText = body = Object.prototype.toString.call(body);\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8');\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type);\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8');\n        }\n      }\n    };\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this);\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyArrayBuffer) {\n          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      };\n\n      this.arrayBuffer = function() {\n        if (this._bodyArrayBuffer) {\n          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n        } else {\n          return this.blob().then(readBlobAsArrayBuffer)\n        }\n      };\n    }\n\n    this.text = function() {\n      var rejected = consumed(this);\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return readBlobAsText(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as text')\n      } else {\n        return Promise.resolve(this._bodyText)\n      }\n    };\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      };\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    };\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT'];\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase();\n    return methods.indexOf(upcased) > -1 ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {};\n    var body = options.body;\n\n    if (input instanceof Request) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url;\n      this.credentials = input.credentials;\n      if (!options.headers) {\n        this.headers = new Headers(input.headers);\n      }\n      this.method = input.method;\n      this.mode = input.mode;\n      this.signal = input.signal;\n      if (!body && input._bodyInit != null) {\n        body = input._bodyInit;\n        input.bodyUsed = true;\n      }\n    } else {\n      this.url = String(input);\n    }\n\n    this.credentials = options.credentials || this.credentials || 'same-origin';\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers);\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET');\n    this.mode = options.mode || this.mode || null;\n    this.signal = options.signal || this.signal;\n    this.referrer = null;\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body);\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this, {body: this._bodyInit})\n  };\n\n  function decode(body) {\n    var form = new FormData();\n    body\n      .trim()\n      .split('&')\n      .forEach(function(bytes) {\n        if (bytes) {\n          var split = bytes.split('=');\n          var name = split.shift().replace(/\\+/g, ' ');\n          var value = split.join('=').replace(/\\+/g, ' ');\n          form.append(decodeURIComponent(name), decodeURIComponent(value));\n        }\n      });\n    return form\n  }\n\n  function parseHeaders(rawHeaders) {\n    var headers = new Headers();\n    // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\n    // https://tools.ietf.org/html/rfc7230#section-3.2\n    var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ');\n    preProcessedHeaders.split(/\\r?\\n/).forEach(function(line) {\n      var parts = line.split(':');\n      var key = parts.shift().trim();\n      if (key) {\n        var value = parts.join(':').trim();\n        headers.append(key, value);\n      }\n    });\n    return headers\n  }\n\n  Body.call(Request.prototype);\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {};\n    }\n\n    this.type = 'default';\n    this.status = options.status === undefined ? 200 : options.status;\n    this.ok = this.status >= 200 && this.status < 300;\n    this.statusText = 'statusText' in options ? options.statusText : 'OK';\n    this.headers = new Headers(options.headers);\n    this.url = options.url || '';\n    this._initBody(bodyInit);\n  }\n\n  Body.call(Response.prototype);\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  };\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''});\n    response.type = 'error';\n    return response\n  };\n\n  var redirectStatuses = [301, 302, 303, 307, 308];\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  };\n\n  exports.DOMException = self.DOMException;\n  try {\n    new exports.DOMException();\n  } catch (err) {\n    exports.DOMException = function(message, name) {\n      this.message = message;\n      this.name = name;\n      var error = Error(message);\n      this.stack = error.stack;\n    };\n    exports.DOMException.prototype = Object.create(Error.prototype);\n    exports.DOMException.prototype.constructor = exports.DOMException;\n  }\n\n  function fetch(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request = new Request(input, init);\n\n      if (request.signal && request.signal.aborted) {\n        return reject(new exports.DOMException('Aborted', 'AbortError'))\n      }\n\n      var xhr = new XMLHttpRequest();\n\n      function abortXhr() {\n        xhr.abort();\n      }\n\n      xhr.onload = function() {\n        var options = {\n          status: xhr.status,\n          statusText: xhr.statusText,\n          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n        };\n        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL');\n        var body = 'response' in xhr ? xhr.response : xhr.responseText;\n        resolve(new Response(body, options));\n      };\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'));\n      };\n\n      xhr.ontimeout = function() {\n        reject(new TypeError('Network request failed'));\n      };\n\n      xhr.onabort = function() {\n        reject(new exports.DOMException('Aborted', 'AbortError'));\n      };\n\n      xhr.open(request.method, request.url, true);\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true;\n      } else if (request.credentials === 'omit') {\n        xhr.withCredentials = false;\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob';\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value);\n      });\n\n      if (request.signal) {\n        request.signal.addEventListener('abort', abortXhr);\n\n        xhr.onreadystatechange = function() {\n          // DONE (success or failure)\n          if (xhr.readyState === 4) {\n            request.signal.removeEventListener('abort', abortXhr);\n          }\n        };\n      }\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit);\n    })\n  }\n\n  fetch.polyfill = true;\n\n  if (!self.fetch) {\n    self.fetch = fetch;\n    self.Headers = Headers;\n    self.Request = Request;\n    self.Response = Response;\n  }\n\n  exports.Headers = Headers;\n  exports.Request = Request;\n  exports.Response = Response;\n  exports.fetch = fetch;\n\n  return exports;\n\n}({}));\n})(__self__);\ndelete __self__.fetch.polyfill\nexports = __self__.fetch // To enable: import fetch from 'cross-fetch'\nexports.default = __self__.fetch // For TypeScript consumers without esModuleInterop.\nexports.fetch = __self__.fetch // To enable: import {fetch} from 'cross-fetch'\nexports.Headers = __self__.Headers\nexports.Request = __self__.Request\nexports.Response = __self__.Response\nmodule.exports = exports\n","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","function _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}\n\nmodule.exports = _isNativeFunction;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nvar isNativeReflectConstruct = require(\"./isNativeReflectConstruct\");\n\nfunction _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    module.exports = _construct = Reflect.construct;\n  } else {\n    module.exports = _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}\n\nmodule.exports = _construct;","function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nmodule.exports = _isNativeReflectConstruct;","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","/*!\n * JavaScript Cookie v2.2.1\n * https://github.com/js-cookie/js-cookie\n *\n * Copyright 2006, 2015 Klaus Hartl & Fagner Brack\n * Released under the MIT license\n */\n;(function (factory) {\n\tvar registeredInModuleLoader;\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(factory);\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (typeof exports === 'object') {\n\t\tmodule.exports = factory();\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (!registeredInModuleLoader) {\n\t\tvar OldCookies = window.Cookies;\n\t\tvar api = window.Cookies = factory();\n\t\tapi.noConflict = function () {\n\t\t\twindow.Cookies = OldCookies;\n\t\t\treturn api;\n\t\t};\n\t}\n}(function () {\n\tfunction extend () {\n\t\tvar i = 0;\n\t\tvar result = {};\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar attributes = arguments[ i ];\n\t\t\tfor (var key in attributes) {\n\t\t\t\tresult[key] = attributes[key];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction decode (s) {\n\t\treturn s.replace(/(%[0-9A-Z]{2})+/g, decodeURIComponent);\n\t}\n\n\tfunction init (converter) {\n\t\tfunction api() {}\n\n\t\tfunction set (key, value, attributes) {\n\t\t\tif (typeof document === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tattributes = extend({\n\t\t\t\tpath: '/'\n\t\t\t}, api.defaults, attributes);\n\n\t\t\tif (typeof attributes.expires === 'number') {\n\t\t\t\tattributes.expires = new Date(new Date() * 1 + attributes.expires * 864e+5);\n\t\t\t}\n\n\t\t\t// We're using \"expires\" because \"max-age\" is not supported by IE\n\t\t\tattributes.expires = attributes.expires ? attributes.expires.toUTCString() : '';\n\n\t\t\ttry {\n\t\t\t\tvar result = JSON.stringify(value);\n\t\t\t\tif (/^[\\{\\[]/.test(result)) {\n\t\t\t\t\tvalue = result;\n\t\t\t\t}\n\t\t\t} catch (e) {}\n\n\t\t\tvalue = converter.write ?\n\t\t\t\tconverter.write(value, key) :\n\t\t\t\tencodeURIComponent(String(value))\n\t\t\t\t\t.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\n\n\t\t\tkey = encodeURIComponent(String(key))\n\t\t\t\t.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent)\n\t\t\t\t.replace(/[\\(\\)]/g, escape);\n\n\t\t\tvar stringifiedAttributes = '';\n\t\t\tfor (var attributeName in attributes) {\n\t\t\t\tif (!attributes[attributeName]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tstringifiedAttributes += '; ' + attributeName;\n\t\t\t\tif (attributes[attributeName] === true) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Considers RFC 6265 section 5.2:\n\t\t\t\t// ...\n\t\t\t\t// 3.  If the remaining unparsed-attributes contains a %x3B (\";\")\n\t\t\t\t//     character:\n\t\t\t\t// Consume the characters of the unparsed-attributes up to,\n\t\t\t\t// not including, the first %x3B (\";\") character.\n\t\t\t\t// ...\n\t\t\t\tstringifiedAttributes += '=' + attributes[attributeName].split(';')[0];\n\t\t\t}\n\n\t\t\treturn (document.cookie = key + '=' + value + stringifiedAttributes);\n\t\t}\n\n\t\tfunction get (key, json) {\n\t\t\tif (typeof document === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar jar = {};\n\t\t\t// To prevent the for loop in the first place assign an empty array\n\t\t\t// in case there are no cookies at all.\n\t\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\n\t\t\tvar i = 0;\n\n\t\t\tfor (; i < cookies.length; i++) {\n\t\t\t\tvar parts = cookies[i].split('=');\n\t\t\t\tvar cookie = parts.slice(1).join('=');\n\n\t\t\t\tif (!json && cookie.charAt(0) === '\"') {\n\t\t\t\t\tcookie = cookie.slice(1, -1);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tvar name = decode(parts[0]);\n\t\t\t\t\tcookie = (converter.read || converter)(cookie, name) ||\n\t\t\t\t\t\tdecode(cookie);\n\n\t\t\t\t\tif (json) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcookie = JSON.parse(cookie);\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t}\n\n\t\t\t\t\tjar[name] = cookie;\n\n\t\t\t\t\tif (key === name) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\n\t\t\treturn key ? jar[key] : jar;\n\t\t}\n\n\t\tapi.set = set;\n\t\tapi.get = function (key) {\n\t\t\treturn get(key, false /* read as raw */);\n\t\t};\n\t\tapi.getJSON = function (key) {\n\t\t\treturn get(key, true /* read as json */);\n\t\t};\n\t\tapi.remove = function (key, attributes) {\n\t\t\tset(key, '', extend(attributes, {\n\t\t\t\texpires: -1\n\t\t\t}));\n\t\t};\n\n\t\tapi.defaults = {};\n\n\t\tapi.withConverter = init;\n\n\t\treturn api;\n\t}\n\n\treturn init(function () {});\n}));\n","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;","function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest;","'use strict';\n\nclass CancelError extends Error {\n\tconstructor(reason) {\n\t\tsuper(reason || 'Promise was canceled');\n\t\tthis.name = 'CancelError';\n\t}\n\n\tget isCanceled() {\n\t\treturn true;\n\t}\n}\n\nclass PCancelable {\n\tstatic fn(userFn) {\n\t\treturn (...arguments_) => {\n\t\t\treturn new PCancelable((resolve, reject, onCancel) => {\n\t\t\t\targuments_.push(onCancel);\n\t\t\t\t// eslint-disable-next-line promise/prefer-await-to-then\n\t\t\t\tuserFn(...arguments_).then(resolve, reject);\n\t\t\t});\n\t\t};\n\t}\n\n\tconstructor(executor) {\n\t\tthis._cancelHandlers = [];\n\t\tthis._isPending = true;\n\t\tthis._isCanceled = false;\n\t\tthis._rejectOnCancel = true;\n\n\t\tthis._promise = new Promise((resolve, reject) => {\n\t\t\tthis._reject = reject;\n\n\t\t\tconst onResolve = value => {\n\t\t\t\tthis._isPending = false;\n\t\t\t\tresolve(value);\n\t\t\t};\n\n\t\t\tconst onReject = error => {\n\t\t\t\tthis._isPending = false;\n\t\t\t\treject(error);\n\t\t\t};\n\n\t\t\tconst onCancel = handler => {\n\t\t\t\tif (!this._isPending) {\n\t\t\t\t\tthrow new Error('The `onCancel` handler was attached after the promise settled.');\n\t\t\t\t}\n\n\t\t\t\tthis._cancelHandlers.push(handler);\n\t\t\t};\n\n\t\t\tObject.defineProperties(onCancel, {\n\t\t\t\tshouldReject: {\n\t\t\t\t\tget: () => this._rejectOnCancel,\n\t\t\t\t\tset: boolean => {\n\t\t\t\t\t\tthis._rejectOnCancel = boolean;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn executor(onResolve, onReject, onCancel);\n\t\t});\n\t}\n\n\tthen(onFulfilled, onRejected) {\n\t\t// eslint-disable-next-line promise/prefer-await-to-then\n\t\treturn this._promise.then(onFulfilled, onRejected);\n\t}\n\n\tcatch(onRejected) {\n\t\treturn this._promise.catch(onRejected);\n\t}\n\n\tfinally(onFinally) {\n\t\treturn this._promise.finally(onFinally);\n\t}\n\n\tcancel(reason) {\n\t\tif (!this._isPending || this._isCanceled) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._cancelHandlers.length > 0) {\n\t\t\ttry {\n\t\t\t\tfor (const handler of this._cancelHandlers) {\n\t\t\t\t\thandler();\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tthis._reject(error);\n\t\t\t}\n\t\t}\n\n\t\tthis._isCanceled = true;\n\t\tif (this._rejectOnCancel) {\n\t\t\tthis._reject(new CancelError(reason));\n\t\t}\n\t}\n\n\tget isCanceled() {\n\t\treturn this._isCanceled;\n\t}\n}\n\nObject.setPrototypeOf(PCancelable.prototype, Promise.prototype);\n\nmodule.exports = PCancelable;\nmodule.exports.CancelError = CancelError;\n","function E () {\n  // Keep this empty so it's easier to inherit from\n  // (via https://github.com/lipsmack from https://github.com/scottcorgan/tiny-emitter/issues/3)\n}\n\nE.prototype = {\n  on: function (name, callback, ctx) {\n    var e = this.e || (this.e = {});\n\n    (e[name] || (e[name] = [])).push({\n      fn: callback,\n      ctx: ctx\n    });\n\n    return this;\n  },\n\n  once: function (name, callback, ctx) {\n    var self = this;\n    function listener () {\n      self.off(name, listener);\n      callback.apply(ctx, arguments);\n    };\n\n    listener._ = callback\n    return this.on(name, listener, ctx);\n  },\n\n  emit: function (name) {\n    var data = [].slice.call(arguments, 1);\n    var evtArr = ((this.e || (this.e = {}))[name] || []).slice();\n    var i = 0;\n    var len = evtArr.length;\n\n    for (i; i < len; i++) {\n      evtArr[i].fn.apply(evtArr[i].ctx, data);\n    }\n\n    return this;\n  },\n\n  off: function (name, callback) {\n    var e = this.e || (this.e = {});\n    var evts = e[name];\n    var liveEvents = [];\n\n    if (evts && callback) {\n      for (var i = 0, len = evts.length; i < len; i++) {\n        if (evts[i].fn !== callback && evts[i].fn._ !== callback)\n          liveEvents.push(evts[i]);\n      }\n    }\n\n    // Remove event from queue to prevent memory leak\n    // Suggested by https://github.com/lazd\n    // Ref: https://github.com/scottcorgan/tiny-emitter/commit/c6ebfaa9bc973b33d110a84a307742b7cf94c953#commitcomment-5024910\n\n    (liveEvents.length)\n      ? e[name] = liveEvents\n      : delete e[name];\n\n    return this;\n  }\n};\n\nmodule.exports = E;\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nexport default class CustomError extends Error {\n    constructor(message) {\n        // https://stackoverflow.com/questions/41102060/typescript-extending-error-class\n        super(message); // 'Error' breaks prototype chain here\n        Object.setPrototypeOf(this, new.target.prototype); // restore prototype chain\n    }\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nimport CustomError from './CustomError';\nexport default class AuthSdkError extends CustomError {\n    constructor(msg, xhr) {\n        super(msg);\n        this.name = 'AuthSdkError';\n        this.errorCode = 'INTERNAL';\n        this.errorSummary = msg;\n        this.errorLink = 'INTERNAL';\n        this.errorId = 'INTERNAL';\n        this.errorCauses = [];\n        if (xhr) {\n            this.xhr = xhr;\n        }\n    }\n}\n","/*!\n * Copyright (c) 2018-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nimport AuthSdkError from './errors/AuthSdkError';\n// TODO: use @okta/configuration-validation (move module to this monorepo?)\n// eslint-disable-next-line complexity\nfunction assertValidConfig(args) {\n    args = args || {};\n    var issuer = args.issuer;\n    if (!issuer) {\n        throw new AuthSdkError('No issuer passed to constructor. ' +\n            'Required usage: new OktaAuth({issuer: \"https://{yourOktaDomain}.com/oauth2/{authServerId}\"})');\n    }\n    var isUrlRegex = new RegExp('^http?s?://.+');\n    if (!isUrlRegex.test(args.issuer)) {\n        throw new AuthSdkError('Issuer must be a valid URL. ' +\n            'Required usage: new OktaAuth({issuer: \"https://{yourOktaDomain}.com/oauth2/{authServerId}\"})');\n    }\n    if (issuer.indexOf('-admin.') !== -1) {\n        throw new AuthSdkError('Issuer URL passed to constructor contains \"-admin\" in subdomain. ' +\n            'Required usage: new OktaAuth({issuer: \"https://{yourOktaDomain}.com})');\n    }\n    var userAgent = args.userAgent;\n    var userAgentTemplateWithNoPlaceholder = userAgent && userAgent.template && userAgent.template.indexOf('$OKTA_AUTH_JS') === -1;\n    if (userAgentTemplateWithNoPlaceholder) {\n        throw new AuthSdkError('UserAgentTemplate must include \"$OKTA_AUTH_JS\" placeholder. ' +\n            'Required usage: new OktaAuth({userAgentTemplate: \"xxx $OKTA_AUTH_JS xxx\"})');\n    }\n}\nfunction getUserAgent(args, sdkValue) {\n    var userAgent = args.userAgent || {};\n    if (userAgent.value) {\n        return userAgent.value;\n    }\n    if (userAgent.template) {\n        return userAgent.template.replace('$OKTA_AUTH_JS', sdkValue);\n    }\n    return sdkValue;\n}\nexport { assertValidConfig, getUserAgent };\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n/* global window, document, btoa, atob */\n// converts a string to base64 (url/filename safe variant)\nexport function stringToBase64Url(str) {\n    var b64 = btoa(str);\n    return base64ToBase64Url(b64);\n}\n// converts a standard base64-encoded string to a \"url/filename safe\" variant\nexport function base64ToBase64Url(b64) {\n    return b64.replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=+$/, '');\n}\n// converts a \"url/filename safe\" base64 string to a \"standard\" base64 string\nexport function base64UrlToBase64(b64u) {\n    return b64u.replace(/-/g, '+').replace(/_/g, '/');\n}\nexport function base64UrlToString(b64u) {\n    var b64 = base64UrlToBase64(b64u);\n    switch (b64.length % 4) {\n        case 0:\n            break;\n        case 2:\n            b64 += '==';\n            break;\n        case 3:\n            b64 += '=';\n            break;\n        default:\n            throw 'Not a valid Base64Url';\n    }\n    var utf8 = atob(b64);\n    try {\n        return decodeURIComponent(escape(utf8));\n    }\n    catch (e) {\n        return utf8;\n    }\n}\nexport function stringToBuffer(str) {\n    var buffer = new Uint8Array(str.length);\n    for (var i = 0; i < str.length; i++) {\n        buffer[i] = str.charCodeAt(i);\n    }\n    return buffer;\n}\nexport function base64UrlDecode(str) {\n    return atob(base64UrlToBase64(str));\n}\nexport function bind(fn, ctx) {\n    var additionalArgs = Array.prototype.slice.call(arguments, 2);\n    return function () {\n        var args = Array.prototype.slice.call(arguments);\n        args = additionalArgs.concat(args);\n        return fn.apply(ctx, args);\n    };\n}\nexport function isAbsoluteUrl(url) {\n    return /^(?:[a-z]+:)?\\/\\//i.test(url);\n}\nexport function toAbsoluteUrl(url = '', baseUrl) {\n    if (isAbsoluteUrl(url)) {\n        return url;\n    }\n    baseUrl = removeTrailingSlash(baseUrl);\n    return url[0] === '/' ? `${baseUrl}${url}` : `${baseUrl}/${url}`;\n}\nexport function toRelativeUrl(url = '', baseUrl) {\n    if (isAbsoluteUrl(url)) {\n        url = url.substring(baseUrl.length);\n    }\n    return url[0] === '/' ? url : `/${url}`;\n}\nexport function isString(obj) {\n    return Object.prototype.toString.call(obj) === '[object String]';\n}\nexport function isObject(obj) {\n    return Object.prototype.toString.call(obj) === '[object Object]';\n}\nexport function isNumber(obj) {\n    return Object.prototype.toString.call(obj) === '[object Number]';\n}\nexport function isoToUTCString(str) {\n    var parts = str.match(/\\d+/g), isoTime = Date.UTC(parts[0], parts[1] - 1, parts[2], parts[3], parts[4], parts[5]), isoDate = new Date(isoTime);\n    return isoDate.toUTCString();\n}\nexport function toQueryString(obj) {\n    var str = [];\n    if (obj !== null) {\n        for (var key in obj) {\n            if (Object.prototype.hasOwnProperty.call(obj, key) &&\n                obj[key] !== undefined &&\n                obj[key] !== null) {\n                str.push(key + '=' + encodeURIComponent(obj[key]));\n            }\n        }\n    }\n    if (str.length) {\n        return '?' + str.join('&');\n    }\n    else {\n        return '';\n    }\n}\nexport function genRandomString(length) {\n    var randomCharset = 'abcdefghijklnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\n    var random = '';\n    for (var c = 0, cl = randomCharset.length; c < length; ++c) {\n        random += randomCharset[Math.floor(Math.random() * cl)];\n    }\n    return random;\n}\n// TODO: replace all references with `Object.assign` then remove this function\nexport function extend() {\n    // First object will be modified!\n    var obj1 = arguments[0];\n    // Properties from other objects will be copied over\n    var objArray = [].slice.call(arguments, 1);\n    objArray.forEach(function (obj) {\n        for (var prop in obj) {\n            // copy over all properties with defined values\n            if (Object.prototype.hasOwnProperty.call(obj, prop) && obj[prop] !== undefined) {\n                obj1[prop] = obj[prop];\n            }\n        }\n    });\n    return obj1; // return the modified object\n}\nexport function removeNils(obj) {\n    var cleaned = {};\n    for (var prop in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, prop)) {\n            var value = obj[prop];\n            if (value !== null && value !== undefined) {\n                cleaned[prop] = value;\n            }\n        }\n    }\n    return cleaned;\n}\nexport function clone(obj) {\n    if (obj) {\n        var str = JSON.stringify(obj);\n        if (str) {\n            return JSON.parse(str);\n        }\n    }\n    return obj;\n}\n// Analogous to _.omit\nexport function omit(obj, ...props) {\n    // var props = Array.prototype.slice.call(arguments, 1);\n    var newobj = {};\n    for (var p in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, p) && props.indexOf(p) == -1) {\n            newobj[p] = obj[p];\n        }\n    }\n    return clone(newobj);\n}\nexport function find(collection, searchParams) {\n    var c = collection.length;\n    while (c--) {\n        var item = collection[c];\n        var found = true;\n        for (var prop in searchParams) {\n            if (!Object.prototype.hasOwnProperty.call(searchParams, prop)) {\n                continue;\n            }\n            if (item[prop] !== searchParams[prop]) {\n                found = false;\n                break;\n            }\n        }\n        if (found) {\n            return item;\n        }\n    }\n}\nexport function getLink(obj, linkName, altName) {\n    if (!obj || !obj._links) {\n        return;\n    }\n    var link = clone(obj._links[linkName]);\n    // If a link has a name and we have an altName, return if they match\n    if (link && link.name && altName) {\n        if (link.name === altName) {\n            return link;\n        }\n    }\n    else {\n        return link;\n    }\n}\nexport function getNativeConsole() {\n    if (typeof window !== 'undefined') {\n        return window.console;\n    }\n    else if (typeof console !== 'undefined') {\n        return console;\n    }\n    else {\n        return undefined;\n    }\n}\nexport function getConsole() {\n    var nativeConsole = getNativeConsole();\n    if (nativeConsole && nativeConsole.log) {\n        return nativeConsole;\n    }\n    return {\n        log: function () { },\n        warn: function () { },\n        group: function () { },\n        groupEnd: function () { }\n    };\n}\nexport function warn(text) {\n    /* eslint-disable no-console */\n    getConsole().warn('[okta-auth-sdk] WARN: ' + text);\n    /* eslint-enable */\n}\nexport function deprecate(text) {\n    /* eslint-disable no-console */\n    getConsole().warn('[okta-auth-sdk] DEPRECATION: ' + text);\n    /* eslint-enable */\n}\nexport function deprecateWrap(text, fn) {\n    return function () {\n        deprecate(text);\n        return fn.apply(null, arguments);\n    };\n}\nexport function removeTrailingSlash(path) {\n    if (!path) {\n        return;\n    }\n    // Remove any whitespace before or after string\n    var trimmed = path.replace(/^\\s+|\\s+$/gm, '');\n    // Remove trailing slash(es)\n    trimmed = trimmed.replace(/\\/+$/, '');\n    return trimmed;\n}\nexport function isIE11OrLess() {\n    return !!document.documentMode && document.documentMode <= 11;\n}\nexport function isFunction(fn) {\n    return !!fn && {}.toString.call(fn) === '[object Function]';\n}\nexport function delay(ms) {\n    return new Promise(function (resolve) {\n        setTimeout(resolve, ms);\n    });\n}\nexport function isPromise(obj) {\n    return obj && obj.finally && (typeof obj.finally === 'function');\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nimport CustomError from './CustomError';\nexport default class AuthApiError extends CustomError {\n    constructor(err, xhr) {\n        const message = err.errorSummary;\n        super(message);\n        this.name = 'AuthApiError';\n        this.errorSummary = err.errorSummary;\n        this.errorCode = err.errorCode;\n        this.errorLink = err.errorLink;\n        this.errorId = err.errorId;\n        this.errorCauses = err.errorCauses;\n        if (xhr) {\n            this.xhr = xhr;\n        }\n    }\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nexport const STATE_TOKEN_KEY_NAME = 'oktaStateToken';\nexport const DEFAULT_POLLING_DELAY = 500;\nexport const DEFAULT_MAX_CLOCK_SKEW = 300;\nexport const DEFAULT_CACHE_DURATION = 86400;\nexport const REDIRECT_OAUTH_PARAMS_NAME = 'okta-oauth-redirect-params';\nexport const REDIRECT_STATE_COOKIE_NAME = 'okta-oauth-state';\nexport const REDIRECT_NONCE_COOKIE_NAME = 'okta-oauth-nonce';\nexport const TOKEN_STORAGE_NAME = 'okta-token-storage';\nexport const CACHE_STORAGE_NAME = 'okta-cache-storage';\nexport const PKCE_STORAGE_NAME = 'okta-pkce-storage';\nexport const TRANSACTION_STORAGE_NAME = 'okta-transaction-storage';\nexport const ACCESS_TOKEN_STORAGE_KEY = 'accessToken';\nexport const ID_TOKEN_STORAGE_KEY = 'idToken';\nexport const REFRESH_TOKEN_STORAGE_KEY = 'refreshToken';\nexport const REFERRER_PATH_STORAGE_KEY = 'referrerPath';\n// Code verifier: Random URL-safe string with a minimum length of 43 characters.\n// Code challenge: Base64 URL-encoded SHA-256 hash of the code verifier.\nexport const MIN_VERIFIER_LENGTH = 43;\nexport const MAX_VERIFIER_LENGTH = 128;\nexport const DEFAULT_CODE_CHALLENGE_METHOD = 'S256';\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\n/* eslint-disable complexity */\nimport { isString, clone, isAbsoluteUrl, removeNils } from './util';\nimport AuthApiError from './errors/AuthApiError';\nimport { STATE_TOKEN_KEY_NAME, DEFAULT_CACHE_DURATION } from './constants';\nfunction httpRequest(sdk, options) {\n    options = options || {};\n    var url = options.url, method = options.method, args = options.args, saveAuthnState = options.saveAuthnState, accessToken = options.accessToken, withCredentials = options.withCredentials !== false, // default value is true\n    storageUtil = sdk.options.storageUtil, storage = storageUtil.storage, httpCache = sdk.storageManager.getHttpCache(sdk.options.cookies);\n    if (options.cacheResponse) {\n        var cacheContents = httpCache.getStorage();\n        var cachedResponse = cacheContents[url];\n        if (cachedResponse && Date.now() / 1000 < cachedResponse.expiresAt) {\n            return Promise.resolve(cachedResponse.response);\n        }\n    }\n    var headers = {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json',\n        'X-Okta-User-Agent-Extended': sdk.userAgent\n    };\n    Object.assign(headers, sdk.options.headers, options.headers);\n    headers = removeNils(headers);\n    if (accessToken && isString(accessToken)) {\n        headers['Authorization'] = 'Bearer ' + accessToken;\n    }\n    var ajaxOptions = {\n        headers: headers,\n        data: args || undefined,\n        withCredentials: withCredentials\n    };\n    var err, res;\n    return sdk.options.httpRequestClient(method, url, ajaxOptions)\n        .then(function (resp) {\n        res = resp.responseText;\n        if (res && isString(res)) {\n            res = JSON.parse(res);\n        }\n        if (saveAuthnState) {\n            if (!res.stateToken) {\n                storage.delete(STATE_TOKEN_KEY_NAME);\n            }\n        }\n        if (res && res.stateToken && res.expiresAt) {\n            storage.set(STATE_TOKEN_KEY_NAME, res.stateToken, res.expiresAt, sdk.options.cookies);\n        }\n        if (res && options.cacheResponse) {\n            httpCache.updateStorage(url, {\n                expiresAt: Math.floor(Date.now() / 1000) + DEFAULT_CACHE_DURATION,\n                response: res\n            });\n        }\n        return res;\n    })\n        .catch(function (resp) {\n        var serverErr = resp.responseText || {};\n        if (isString(serverErr)) {\n            try {\n                serverErr = JSON.parse(serverErr);\n            }\n            catch (e) {\n                serverErr = {\n                    errorSummary: 'Unknown error'\n                };\n            }\n        }\n        if (resp.status >= 500) {\n            serverErr.errorSummary = 'Unknown error';\n        }\n        if (sdk.options.transformErrorXHR) {\n            resp = sdk.options.transformErrorXHR(clone(resp));\n        }\n        err = new AuthApiError(serverErr, resp);\n        if (err.errorCode === 'E0000011') {\n            storage.delete(STATE_TOKEN_KEY_NAME);\n        }\n        throw err;\n    });\n}\nfunction get(sdk, url, options) {\n    url = isAbsoluteUrl(url) ? url : sdk.getIssuerOrigin() + url;\n    var getOptions = {\n        url: url,\n        method: 'GET'\n    };\n    Object.assign(getOptions, options);\n    return httpRequest(sdk, getOptions);\n}\nfunction post(sdk, url, args, options) {\n    url = isAbsoluteUrl(url) ? url : sdk.getIssuerOrigin() + url;\n    var postOptions = {\n        url: url,\n        method: 'POST',\n        args: args,\n        saveAuthnState: true\n    };\n    Object.assign(postOptions, options);\n    return httpRequest(sdk, postOptions);\n}\nexport default {\n    get: get,\n    post: post,\n    httpRequest: httpRequest\n};\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nexport function addStateToken(res, options) {\n    var builtArgs = {};\n    Object.assign(builtArgs, options);\n    // Add the stateToken if one isn't passed and we have one\n    if (!builtArgs.stateToken && res.stateToken) {\n        builtArgs.stateToken = res.stateToken;\n    }\n    return builtArgs;\n}\nexport function getStateToken(res) {\n    return addStateToken(res);\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nimport CustomError from './CustomError';\nexport default class AuthPollStopError extends CustomError {\n    constructor() {\n        const message = 'The poll was stopped by the sdk';\n        super(message);\n    }\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport http from '../http';\nimport { isNumber, isObject, getLink, toQueryString, delay as delayFn } from '../util';\nimport { DEFAULT_POLLING_DELAY } from '../constants';\nimport AuthSdkError from '../errors/AuthSdkError';\nimport AuthPollStopError from '../errors/AuthPollStopError';\nimport { AuthTransaction } from './AuthTransaction';\nimport { getStateToken } from './util';\nexport function getPollFn(sdk, res, ref) {\n    return function (options) {\n        var delay;\n        var rememberDevice;\n        var autoPush;\n        var transactionCallBack;\n        if (isNumber(options)) {\n            delay = options;\n        }\n        else if (isObject(options)) {\n            options = options;\n            delay = options.delay;\n            rememberDevice = options.rememberDevice;\n            autoPush = options.autoPush;\n            transactionCallBack = options.transactionCallBack;\n        }\n        if (!delay && delay !== 0) {\n            delay = DEFAULT_POLLING_DELAY;\n        }\n        // Get the poll function\n        var pollLink = getLink(res, 'next', 'poll');\n        // eslint-disable-next-line complexity\n        function pollFn() {\n            var opts = {};\n            if (typeof autoPush === 'function') {\n                try {\n                    opts.autoPush = !!autoPush();\n                }\n                catch (e) {\n                    return Promise.reject(new AuthSdkError('AutoPush resulted in an error.'));\n                }\n            }\n            else if (autoPush !== undefined && autoPush !== null) {\n                opts.autoPush = !!autoPush;\n            }\n            if (typeof rememberDevice === 'function') {\n                try {\n                    opts.rememberDevice = !!rememberDevice();\n                }\n                catch (e) {\n                    return Promise.reject(new AuthSdkError('RememberDevice resulted in an error.'));\n                }\n            }\n            else if (rememberDevice !== undefined && rememberDevice !== null) {\n                opts.rememberDevice = !!rememberDevice;\n            }\n            var href = pollLink.href + toQueryString(opts);\n            return http.post(sdk, href, getStateToken(res), {\n                saveAuthnState: false\n            });\n        }\n        ref.isPolling = true;\n        var retryCount = 0;\n        var recursivePoll = function () {\n            // If the poll was manually stopped during the delay\n            if (!ref.isPolling) {\n                return Promise.reject(new AuthPollStopError());\n            }\n            return pollFn()\n                .then(function (pollRes) {\n                // Reset our retry counter on success\n                retryCount = 0;\n                // If we're still waiting\n                if (pollRes.factorResult && pollRes.factorResult === 'WAITING') {\n                    // If the poll was manually stopped while the pollFn was called\n                    if (!ref.isPolling) {\n                        throw new AuthPollStopError();\n                    }\n                    if (typeof transactionCallBack === 'function') {\n                        transactionCallBack(pollRes);\n                    }\n                    // Continue poll\n                    return delayFn(delay).then(recursivePoll);\n                }\n                else {\n                    // Any non-waiting result, even if polling was stopped\n                    // during a request, will return\n                    ref.isPolling = false;\n                    return new AuthTransaction(sdk, pollRes);\n                }\n            })\n                .catch(function (err) {\n                // Exponential backoff, up to 16 seconds\n                if (err.xhr &&\n                    (err.xhr.status === 0 || err.xhr.status === 429) &&\n                    retryCount <= 4) {\n                    var delayLength = Math.pow(2, retryCount) * 1000;\n                    retryCount++;\n                    return delayFn(delayLength)\n                        .then(recursivePoll);\n                }\n                throw err;\n            });\n        };\n        return recursivePoll()\n            .catch(function (err) {\n            ref.isPolling = false;\n            throw err;\n        });\n    };\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport http from '../http';\nimport { find, omit, toQueryString, clone, isObject } from '../util';\nimport AuthSdkError from '../errors/AuthSdkError';\nimport { addStateToken } from './util';\nimport { getPollFn } from './poll';\nimport { postToTransaction } from './api';\nexport class AuthTransaction {\n    constructor(sdk, res = null) {\n        if (res) {\n            this.data = res;\n            Object.assign(this, flattenEmbedded(sdk, res, res, {}));\n            delete this.stateToken;\n            // RECOVERY_CHALLENGE has some responses without _links.\n            // Without _links, we emulate cancel to make it intuitive\n            // to return to the starting state. We may remove this\n            // when OKTA-75434 is resolved\n            if (res.status === 'RECOVERY_CHALLENGE' && !res._links) {\n                this.cancel = function () {\n                    return Promise.resolve(new AuthTransaction(sdk));\n                };\n            }\n        }\n    }\n}\nfunction link2fn(sdk, res, obj, link, ref) {\n    if (Array.isArray(link)) {\n        return function (name, opts) {\n            if (!name) {\n                throw new AuthSdkError('Must provide a link name');\n            }\n            var lk = find(link, { name: name });\n            if (!lk) {\n                throw new AuthSdkError('No link found for that name');\n            }\n            return link2fn(sdk, res, obj, lk, ref)(opts);\n        };\n    }\n    else if (link.hints &&\n        link.hints.allow &&\n        link.hints.allow.length === 1) {\n        var method = link.hints.allow[0];\n        switch (method) {\n            case 'GET':\n                return function () {\n                    return http.get(sdk, link.href);\n                };\n            case 'POST':\n                // eslint-disable-next-line max-statements,complexity\n                return function (opts) {\n                    if (ref && ref.isPolling) {\n                        ref.isPolling = false;\n                    }\n                    var data = addStateToken(res, opts);\n                    if (res.status === 'MFA_ENROLL' || res.status === 'FACTOR_ENROLL') {\n                        // Add factorType and provider\n                        Object.assign(data, {\n                            factorType: obj.factorType,\n                            provider: obj.provider\n                        });\n                    }\n                    var params = {};\n                    var autoPush = data.autoPush;\n                    if (autoPush !== undefined) {\n                        if (typeof autoPush === 'function') {\n                            try {\n                                params.autoPush = !!autoPush();\n                            }\n                            catch (e) {\n                                return Promise.reject(new AuthSdkError('AutoPush resulted in an error.'));\n                            }\n                        }\n                        else if (autoPush !== null) {\n                            params.autoPush = !!autoPush;\n                        }\n                        data = omit(data, 'autoPush');\n                    }\n                    var rememberDevice = data.rememberDevice;\n                    if (rememberDevice !== undefined) {\n                        if (typeof rememberDevice === 'function') {\n                            try {\n                                params.rememberDevice = !!rememberDevice();\n                            }\n                            catch (e) {\n                                return Promise.reject(new AuthSdkError('RememberDevice resulted in an error.'));\n                            }\n                        }\n                        else if (rememberDevice !== null) {\n                            params.rememberDevice = !!rememberDevice;\n                        }\n                        data = omit(data, 'rememberDevice');\n                    }\n                    else if (data.profile &&\n                        data.profile.updatePhone !== undefined) {\n                        if (data.profile.updatePhone) {\n                            params.updatePhone = true;\n                        }\n                        data.profile = omit(data.profile, 'updatePhone');\n                    }\n                    var href = link.href + toQueryString(params);\n                    return postToTransaction(sdk, href, data);\n                };\n        }\n    }\n}\nfunction links2fns(sdk, res, obj, ref) {\n    var fns = {};\n    for (var linkName in obj._links) {\n        if (!Object.prototype.hasOwnProperty.call(obj._links, linkName)) {\n            continue;\n        }\n        var link = obj._links[linkName];\n        if (linkName === 'next') {\n            linkName = link.name;\n        }\n        if (link.type) {\n            fns[linkName] = link;\n            continue;\n        }\n        switch (linkName) {\n            // poll is only found at the transaction\n            // level, so we don't need to pass the link\n            case 'poll':\n                fns.poll = getPollFn(sdk, res, ref);\n                break;\n            default:\n                var fn = link2fn(sdk, res, obj, link, ref);\n                if (fn) {\n                    fns[linkName] = fn;\n                }\n        }\n    }\n    return fns;\n}\n// eslint-disable-next-line complexity\nfunction flattenEmbedded(sdk, res, obj, ref) {\n    obj = obj || res;\n    obj = clone(obj);\n    if (Array.isArray(obj)) {\n        var objArr = [];\n        for (var o = 0, ol = obj.length; o < ol; o++) {\n            objArr.push(flattenEmbedded(sdk, res, obj[o], ref));\n        }\n        return objArr;\n    }\n    var embedded = obj._embedded || {};\n    for (var key in embedded) {\n        if (!Object.prototype.hasOwnProperty.call(embedded, key)) {\n            continue;\n        }\n        // Flatten any nested _embedded objects\n        if (isObject(embedded[key]) || Array.isArray(embedded[key])) {\n            embedded[key] = flattenEmbedded(sdk, res, embedded[key], ref);\n        }\n    }\n    // Convert any links on the embedded object\n    var fns = links2fns(sdk, res, obj, ref);\n    Object.assign(embedded, fns);\n    obj = omit(obj, '_embedded', '_links');\n    Object.assign(obj, embedded);\n    return obj;\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\n/* eslint-disable complexity, max-statements */\nimport http from '../http';\nimport AuthSdkError from '../errors/AuthSdkError';\nimport { STATE_TOKEN_KEY_NAME } from '../constants';\nimport { addStateToken } from './util';\nimport { AuthTransaction } from './AuthTransaction';\nfunction transactionStatus(sdk, args) {\n    args = addStateToken(sdk, args);\n    return http.post(sdk, sdk.getIssuerOrigin() + '/api/v1/authn', args);\n}\nfunction resumeTransaction(sdk, args) {\n    if (!args || !args.stateToken) {\n        var stateToken = sdk.tx.exists._get(STATE_TOKEN_KEY_NAME);\n        if (stateToken) {\n            args = {\n                stateToken: stateToken\n            };\n        }\n        else {\n            return Promise.reject(new AuthSdkError('No transaction to resume'));\n        }\n    }\n    return sdk.tx.status(args)\n        .then(function (res) {\n        return new AuthTransaction(sdk, res);\n    });\n}\nfunction introspect(sdk, args) {\n    if (!args || !args.stateToken) {\n        var stateToken = sdk.tx.exists._get(STATE_TOKEN_KEY_NAME);\n        if (stateToken) {\n            args = {\n                stateToken: stateToken\n            };\n        }\n        else {\n            return Promise.reject(new AuthSdkError('No transaction to evaluate'));\n        }\n    }\n    return transactionStep(sdk, args)\n        .then(function (res) {\n        return new AuthTransaction(sdk, res);\n    });\n}\nfunction transactionStep(sdk, args) {\n    args = addStateToken(sdk, args);\n    // v1 pipeline introspect API\n    return http.post(sdk, sdk.getIssuerOrigin() + '/api/v1/authn/introspect', args);\n}\nfunction transactionExists(sdk) {\n    // We have a cookie state token\n    return !!sdk.tx.exists._get(STATE_TOKEN_KEY_NAME);\n}\nfunction postToTransaction(sdk, url, args, options) {\n    return http.post(sdk, url, args, options)\n        .then(function (res) {\n        return new AuthTransaction(sdk, res);\n    });\n}\nexport { transactionStatus, resumeTransaction, transactionExists, postToTransaction, introspect, };\n","export class TransactionState {\n}\n","/*!\n * Copyright (c) 2019-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\n/* global crypto */\n/* eslint-disable complexity, max-statements */\nimport { stringToBase64Url } from '../../util';\nimport { MIN_VERIFIER_LENGTH, MAX_VERIFIER_LENGTH, DEFAULT_CODE_CHALLENGE_METHOD } from '../../constants';\nfunction dec2hex(dec) {\n    return ('0' + dec.toString(16)).substr(-2);\n}\nfunction getRandomString(length) {\n    var a = new Uint8Array(Math.ceil(length / 2));\n    crypto.getRandomValues(a);\n    var str = Array.from(a, dec2hex).join('');\n    return str.slice(0, length);\n}\nfunction generateVerifier(prefix) {\n    var verifier = prefix || '';\n    if (verifier.length < MIN_VERIFIER_LENGTH) {\n        verifier = verifier + getRandomString(MIN_VERIFIER_LENGTH - verifier.length);\n    }\n    return encodeURIComponent(verifier).slice(0, MAX_VERIFIER_LENGTH);\n}\nfunction computeChallenge(str) {\n    var buffer = new TextEncoder().encode(str);\n    return crypto.subtle.digest('SHA-256', buffer).then(function (arrayBuffer) {\n        var hash = String.fromCharCode.apply(null, new Uint8Array(arrayBuffer));\n        var b64u = stringToBase64Url(hash); // url-safe base64 variant\n        return b64u;\n    });\n}\nexport default {\n    DEFAULT_CODE_CHALLENGE_METHOD,\n    generateVerifier,\n    computeChallenge\n};\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport AuthSdkError from './errors/AuthSdkError';\n// formerly known as \"storageBuilder\". Represents an object saved under a key/name.\nexport default class SavedObject {\n    constructor(storage, storageName) {\n        if (!storage) {\n            throw new AuthSdkError('\"storage\" is required');\n        }\n        if (typeof storageName !== 'string' || !storageName.length) {\n            throw new AuthSdkError('\"storageName\" is required');\n        }\n        this.storageName = storageName;\n        this.storageProvider = storage;\n    }\n    //\n    // SimpleStorage interface\n    //\n    getItem(key) {\n        return this.getStorage()[key];\n    }\n    setItem(key, value) {\n        return this.updateStorage(key, value);\n    }\n    removeItem(key) {\n        return this.clearStorage(key);\n    }\n    //\n    // StorageProvider interface\n    //\n    getStorage() {\n        var storageString = this.storageProvider.getItem(this.storageName);\n        storageString = storageString || '{}';\n        try {\n            return JSON.parse(storageString);\n        }\n        catch (e) {\n            throw new AuthSdkError('Unable to parse storage string: ' + this.storageName);\n        }\n    }\n    setStorage(obj) {\n        try {\n            var storageString = obj ? JSON.stringify(obj) : '{}';\n            this.storageProvider.setItem(this.storageName, storageString);\n        }\n        catch (e) {\n            throw new AuthSdkError('Unable to set storage: ' + this.storageName);\n        }\n    }\n    clearStorage(key) {\n        if (!key) {\n            // clear all\n            if (this.storageProvider.removeItem) {\n                this.storageProvider.removeItem(this.storageName);\n            }\n            else {\n                this.setStorage();\n            }\n            return;\n        }\n        var obj = this.getStorage();\n        delete obj[key];\n        this.setStorage(obj);\n    }\n    updateStorage(key, value) {\n        var obj = this.getStorage();\n        obj[key] = value;\n        this.setStorage(obj);\n    }\n}\n","import { PKCE_STORAGE_NAME, TOKEN_STORAGE_NAME, TRANSACTION_STORAGE_NAME, CACHE_STORAGE_NAME, REDIRECT_OAUTH_PARAMS_NAME } from './constants';\nimport SavedObject from './SavedObject';\nexport default class StorageManager {\n    constructor(storageManagerOptions, cookieOptions, storageUtil) {\n        this.storageManagerOptions = storageManagerOptions;\n        this.cookieOptions = cookieOptions;\n        this.storageUtil = storageUtil;\n    }\n    // combines defaults in order\n    getOptionsForSection(sectionName, overrideOptions) {\n        return Object.assign({}, this.storageManagerOptions[sectionName], overrideOptions);\n    }\n    // generic method to get any available storage provider\n    getStorage(options) {\n        options = Object.assign({}, this.cookieOptions, options); // set defaults\n        if (options.storageProvider) {\n            return options.storageProvider;\n        }\n        let { storageType, storageTypes } = options;\n        // Maintain compatibility. Automatically fallback. May change in next major version. OKTA-362589\n        if (storageType && storageTypes) {\n            const idx = storageTypes.indexOf(storageType);\n            if (idx >= 0) {\n                storageTypes = storageTypes.slice(idx);\n                storageType = null;\n            }\n        }\n        if (!storageType) {\n            storageType = this.storageUtil.findStorageType(storageTypes);\n        }\n        return this.storageUtil.getStorageByType(storageType, options);\n    }\n    // stateToken, interactionHandle\n    getTransactionStorage(options) {\n        options = this.getOptionsForSection('transaction', options);\n        const storage = this.getStorage(options);\n        const storageKey = options.storageKey || TRANSACTION_STORAGE_NAME;\n        return new SavedObject(storage, storageKey);\n    }\n    // access_token, id_token, refresh_token\n    getTokenStorage(options) {\n        options = this.getOptionsForSection('token', options);\n        const storage = this.getStorage(options);\n        const storageKey = options.storageKey || TOKEN_STORAGE_NAME;\n        return new SavedObject(storage, storageKey);\n    }\n    // caches well-known response, among others\n    getHttpCache(options) {\n        options = this.getOptionsForSection('cache', options);\n        const storage = this.getStorage(options);\n        const storageKey = options.storageKey || CACHE_STORAGE_NAME;\n        return new SavedObject(storage, storageKey);\n    }\n    // Will be removed in an upcoming major version. OKTA-362589\n    getLegacyPKCEStorage(options) {\n        options = this.getOptionsForSection('legacy-pkce', options);\n        const storage = this.getStorage(options);\n        const storageKey = options.storageKey || PKCE_STORAGE_NAME;\n        return new SavedObject(storage, storageKey);\n    }\n    getLegacyOAuthParamsStorage(options) {\n        options = this.getOptionsForSection('legacy-oauth-params', options);\n        const storage = this.getStorage(options);\n        const storageKey = options.storageKey || REDIRECT_OAUTH_PARAMS_NAME;\n        return new SavedObject(storage, storageKey);\n    }\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nimport CustomError from './CustomError';\nexport default class OAuthError extends CustomError {\n    constructor(errorCode, summary) {\n        super(summary);\n        this.name = 'OAuthError';\n        this.errorCode = errorCode;\n        this.errorSummary = summary;\n    }\n}\n","function isObjectWithProperties(obj) {\n    if (!obj || typeof obj !== 'object' || Object.values(obj).length === 0) {\n        return false;\n    }\n    return true;\n}\nexport function isOAuthTransactionMeta(obj) {\n    if (!isObjectWithProperties(obj)) {\n        return false;\n    }\n    return !!obj.redirectUri || !!obj.responseType;\n}\nexport function isPKCETransactionMeta(obj) {\n    if (!isOAuthTransactionMeta(obj)) {\n        return false;\n    }\n    return !!obj.codeVerifier;\n}\nexport function isIdxTransactionMeta(obj) {\n    if (!isPKCETransactionMeta(obj)) {\n        return false;\n    }\n    return !!obj.interactionHandle;\n}\nexport function isCustomAuthTransactionMeta(obj) {\n    if (!isObjectWithProperties(obj)) {\n        return false;\n    }\n    const isAllStringValues = Object.values(obj).find((value) => (typeof value !== 'string')) === undefined;\n    return isAllStringValues;\n}\nexport function isTransactionMeta(obj) {\n    if (isOAuthTransactionMeta(obj) || isCustomAuthTransactionMeta(obj)) {\n        return true;\n    }\n    return false;\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nexport function isToken(obj) {\n    if (obj &&\n        (obj.accessToken || obj.idToken || obj.refreshToken) &&\n        Array.isArray(obj.scopes)) {\n        return true;\n    }\n    return false;\n}\nexport function isAccessToken(obj) {\n    return obj && obj.accessToken;\n}\nexport function isIDToken(obj) {\n    return obj && obj.idToken;\n}\nexport function isRefreshToken(obj) {\n    return obj && obj.refreshToken;\n}\n","import { AuthSdkError } from './errors';\nimport { REDIRECT_NONCE_COOKIE_NAME, REDIRECT_OAUTH_PARAMS_NAME, REDIRECT_STATE_COOKIE_NAME } from './constants';\nimport { isTransactionMeta, isOAuthTransactionMeta } from './types';\nimport { warn } from './util';\nexport default class TransactionManager {\n    constructor(options) {\n        this.storageManager = options.storageManager;\n        this.legacyWidgetSupport = options.legacyWidgetSupport === false ? false : true;\n        this.saveNonceCookie = options.saveNonceCookie === false ? false : true;\n        this.saveStateCookie = options.saveStateCookie === false ? false : true;\n        this.saveParamsCookie = options.saveParamsCookie === false ? false : true;\n        this.options = options;\n    }\n    clear(options = {}) {\n        let storage = this.storageManager.getTransactionStorage();\n        storage.clearStorage();\n        if (!this.legacyWidgetSupport) {\n            return;\n        }\n        // This is for compatibility with older versions of the signin widget. OKTA-304806\n        if (options.oauth) {\n            this.clearLegacyOAuthParams();\n        }\n        if (options.pkce) {\n            this.clearLegacyPKCE();\n        }\n    }\n    // eslint-disable-next-line complexity\n    save(meta, options = {}) {\n        // There must be only one transaction executing at a time.\n        // Before saving, check to see if a transaction is already stored.\n        // An existing transaction indicates a concurrency/race/overlap condition\n        let storage = this.storageManager.getTransactionStorage();\n        const obj = storage.getStorage();\n        if (isTransactionMeta(obj)) {\n            // eslint-disable-next-line max-len\n            warn('a saved auth transaction exists in storage. This may indicate another auth flow is already in progress.');\n        }\n        storage.setStorage(meta);\n        if (!options.oauth) {\n            return;\n        }\n        if (this.saveNonceCookie || this.saveStateCookie || this.saveParamsCookie) {\n            const cookieStorage = this.storageManager.getStorage({ storageType: 'cookie' });\n            if (this.saveParamsCookie) {\n                const { responseType, state, nonce, scopes, clientId, urls, ignoreSignature } = meta;\n                const oauthParams = {\n                    responseType,\n                    state,\n                    nonce,\n                    scopes,\n                    clientId,\n                    urls,\n                    ignoreSignature\n                };\n                cookieStorage.setItem(REDIRECT_OAUTH_PARAMS_NAME, JSON.stringify(oauthParams), null);\n            }\n            if (this.saveNonceCookie && meta.nonce) {\n                // Set nonce cookie for servers to validate nonce in id_token\n                cookieStorage.setItem(REDIRECT_NONCE_COOKIE_NAME, meta.nonce, null);\n            }\n            if (this.saveStateCookie && meta.state) {\n                // Set state cookie for servers to validate state\n                cookieStorage.setItem(REDIRECT_STATE_COOKIE_NAME, meta.state, null);\n            }\n        }\n    }\n    exists(options = {}) {\n        try {\n            const meta = this.load(options);\n            return !!meta;\n        }\n        catch (_a) {\n            return false;\n        }\n    }\n    // load transaction meta from storage\n    load(options = {}) {\n        let storage = this.storageManager.getTransactionStorage();\n        let meta = storage.getStorage();\n        if (isTransactionMeta(meta)) {\n            // if we have meta in the new location, there is no need to go further\n            return meta;\n        }\n        if (!this.legacyWidgetSupport) {\n            return null;\n        }\n        // This is for compatibility with older versions of the signin widget. OKTA-304806\n        if (options.oauth) {\n            try {\n                const oauthParams = this.loadLegacyOAuthParams();\n                Object.assign(meta, oauthParams);\n            }\n            finally {\n                this.clearLegacyOAuthParams();\n            }\n        }\n        if (options.pkce) {\n            try {\n                const pkceMeta = this.loadLegacyPKCE();\n                Object.assign(meta, pkceMeta);\n            }\n            finally {\n                this.clearLegacyPKCE();\n            }\n        }\n        if (isTransactionMeta(meta)) {\n            return meta;\n        }\n        return null;\n    }\n    // This is for compatibility with older versions of the signin widget. OKTA-304806\n    clearLegacyPKCE() {\n        // clear storages\n        let storage;\n        if (this.storageManager.storageUtil.testStorageType('localStorage')) {\n            storage = this.storageManager.getLegacyPKCEStorage({ storageType: 'localStorage' });\n            storage.clearStorage();\n        }\n        if (this.storageManager.storageUtil.testStorageType('sessionStorage')) {\n            storage = this.storageManager.getLegacyPKCEStorage({ storageType: 'sessionStorage' });\n            storage.clearStorage();\n        }\n    }\n    loadLegacyPKCE() {\n        let storage;\n        let obj;\n        // Try reading from localStorage first.\n        if (this.storageManager.storageUtil.testStorageType('localStorage')) {\n            storage = this.storageManager.getLegacyPKCEStorage({ storageType: 'localStorage' });\n            obj = storage.getStorage();\n            if (obj && obj.codeVerifier) {\n                return obj;\n            }\n        }\n        // If meta is not valid, read from sessionStorage. This is expected for more recent versions of the widget.\n        if (this.storageManager.storageUtil.testStorageType('sessionStorage')) {\n            storage = this.storageManager.getLegacyPKCEStorage({ storageType: 'sessionStorage' });\n            obj = storage.getStorage();\n            if (obj && obj.codeVerifier) {\n                return obj;\n            }\n        }\n        // If meta is not valid, throw an exception to avoid misleading server-side error\n        // The most likely cause of this error is trying to handle a callback twice\n        // eslint-disable-next-line max-len\n        throw new AuthSdkError('Could not load PKCE codeVerifier from storage. This may indicate the auth flow has already completed or multiple auth flows are executing concurrently.', null);\n    }\n    clearLegacyOAuthParams() {\n        // clear storages\n        let storage;\n        if (this.storageManager.storageUtil.testStorageType('sessionStorage')) {\n            storage = this.storageManager.getLegacyOAuthParamsStorage({ storageType: 'sessionStorage' });\n            storage.clearStorage();\n        }\n        if (this.storageManager.storageUtil.testStorageType('cookie')) {\n            storage = this.storageManager.getLegacyOAuthParamsStorage({ storageType: 'cookie' });\n            storage.clearStorage();\n        }\n    }\n    loadLegacyOAuthParams() {\n        let storage;\n        let oauthParams;\n        // load first from session storage\n        if (this.storageManager.storageUtil.testStorageType('sessionStorage')) {\n            storage = this.storageManager.getLegacyOAuthParamsStorage({ storageType: 'sessionStorage' });\n            oauthParams = storage.getStorage();\n        }\n        if (isOAuthTransactionMeta(oauthParams)) {\n            return oauthParams;\n        }\n        // try to load from cookie\n        if (this.storageManager.storageUtil.testStorageType('cookie')) {\n            storage = this.storageManager.getLegacyOAuthParamsStorage({ storageType: 'cookie' });\n            oauthParams = storage.getStorage();\n        }\n        if (isOAuthTransactionMeta(oauthParams)) {\n            return oauthParams;\n        }\n        throw new AuthSdkError('Unable to retrieve OAuth redirect params from storage');\n        // Something is there but we don't recognize it\n        // throw new AuthSdkError('Unable to parse the ' + REDIRECT_OAUTH_PARAMS_NAME + ' value from storage');\n    }\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nimport { assertValidConfig } from './builderUtil';\nimport { removeTrailingSlash } from './util';\nimport { transactionStatus, resumeTransaction, transactionExists, introspect, postToTransaction } from './tx';\nimport PKCE from './oidc/util/pkce';\nimport StorageManager from './StorageManager';\nimport TransactionManager from './TransactionManager';\nexport default class OktaAuthBase {\n    constructor(args) {\n        assertValidConfig(args);\n        this.options = {\n            // OIDC configuration\n            issuer: removeTrailingSlash(args.issuer),\n            tokenUrl: removeTrailingSlash(args.tokenUrl),\n            authorizeUrl: removeTrailingSlash(args.authorizeUrl),\n            userinfoUrl: removeTrailingSlash(args.userinfoUrl),\n            revokeUrl: removeTrailingSlash(args.revokeUrl),\n            logoutUrl: removeTrailingSlash(args.logoutUrl),\n            clientId: args.clientId,\n            redirectUri: args.redirectUri,\n            state: args.state,\n            scopes: args.scopes,\n            postLogoutRedirectUri: args.postLogoutRedirectUri,\n            responseMode: args.responseMode,\n            responseType: args.responseType,\n            pkce: args.pkce,\n            // Internal options\n            httpRequestClient: args.httpRequestClient,\n            transformErrorXHR: args.transformErrorXHR,\n            transformAuthState: args.transformAuthState,\n            restoreOriginalUri: args.restoreOriginalUri,\n            storageUtil: args.storageUtil,\n            headers: args.headers,\n            devMode: args.devMode || false,\n            storageManager: Object.assign({\n                token: {},\n                transaction: {}\n            }, args.storageManager),\n            cookies: args.cookies,\n            // Give the developer the ability to disable token signature validation.\n            ignoreSignature: !!args.ignoreSignature\n        };\n        const { storageManager, cookies, storageUtil } = this.options;\n        this.storageManager = new StorageManager(storageManager, cookies, storageUtil);\n        this.transactionManager = new TransactionManager(Object.assign({\n            storageManager: this.storageManager\n        }, args.transactionManager));\n        this.tx = {\n            status: transactionStatus.bind(null, this),\n            resume: resumeTransaction.bind(null, this),\n            exists: Object.assign(transactionExists.bind(null, this), {\n                _get: (name) => {\n                    const storage = storageUtil.storage;\n                    return storage.get(name);\n                }\n            }),\n            introspect: introspect.bind(null, this)\n        };\n        this.pkce = {\n            DEFAULT_CODE_CHALLENGE_METHOD: PKCE.DEFAULT_CODE_CHALLENGE_METHOD,\n            generateVerifier: PKCE.generateVerifier,\n            computeChallenge: PKCE.computeChallenge\n        };\n    }\n    // { username, password, (relayState), (context) }\n    signIn(opts) {\n        return postToTransaction(this, '/api/v1/authn', opts);\n    }\n    getIssuerOrigin() {\n        // Infer the URL from the issuer URL, omitting the /oauth2/{authServerId}\n        return this.options.issuer.split('/oauth2/')[0];\n    }\n    // { username, (relayState) }\n    forgotPassword(opts) {\n        return postToTransaction(this, '/api/v1/authn/recovery/password', opts);\n    }\n    // { username, (relayState) }\n    unlockAccount(opts) {\n        return postToTransaction(this, '/api/v1/authn/recovery/unlock', opts);\n    }\n    // { recoveryToken }\n    verifyRecoveryToken(opts) {\n        return postToTransaction(this, '/api/v1/authn/recovery/token', opts);\n    }\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nconst isWindowsPhone = /windows phone|iemobile|wpdesktop/i;\nexport function getUserAgent() {\n    return navigator.userAgent;\n}\nexport function isFingerprintSupported() {\n    const agent = getUserAgent();\n    return agent && !isWindowsPhone.test(agent);\n}\nexport function isPopupPostMessageSupported() {\n    var isIE8or9 = document.documentMode && document.documentMode < 10;\n    if (window.postMessage && !isIE8or9) {\n        return true;\n    }\n    return false;\n}\nexport function isTokenVerifySupported() {\n    return typeof crypto !== 'undefined' && crypto.subtle && typeof Uint8Array !== 'undefined';\n}\nexport function hasTextEncoder() {\n    return typeof TextEncoder !== 'undefined';\n}\nexport function isPKCESupported() {\n    return isTokenVerifySupported() && hasTextEncoder();\n}\nexport function isHTTPS() {\n    return window.location.protocol === 'https:';\n}\nexport function isLocalhost() {\n    return window.location.hostname === 'localhost';\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport AuthSdkError from '../errors/AuthSdkError';\nimport { warn } from '../util';\nconst Cookies = require('js-cookie');\n// Building this as an object allows us to mock the functions in our tests\nvar storageUtil = {\n    // These are shimmed in `OktaAuthBase.ts`\n    getHttpCache() {\n        return null;\n    },\n    getPKCEStorage() {\n        return null;\n    },\n    // IE11 bug that Microsoft doesn't plan to fix\n    // https://connect.microsoft.com/IE/Feedback/Details/1496040\n    browserHasLocalStorage: function () {\n        try {\n            var storage = storageUtil.getLocalStorage();\n            return storageUtil.testStorage(storage);\n        }\n        catch (e) {\n            return false;\n        }\n    },\n    browserHasSessionStorage: function () {\n        try {\n            var storage = storageUtil.getSessionStorage();\n            return storageUtil.testStorage(storage);\n        }\n        catch (e) {\n            return false;\n        }\n    },\n    testStorageType: function (storageType) {\n        var supported = false;\n        switch (storageType) {\n            case 'sessionStorage':\n                supported = storageUtil.browserHasSessionStorage();\n                break;\n            case 'localStorage':\n                supported = storageUtil.browserHasLocalStorage();\n                break;\n            case 'cookie':\n            case 'memory':\n                supported = true;\n                break;\n            default:\n                supported = false;\n                break;\n        }\n        return supported;\n    },\n    getStorageByType: function (storageType, options) {\n        let storageProvider = null;\n        switch (storageType) {\n            case 'sessionStorage':\n                storageProvider = storageUtil.getSessionStorage();\n                break;\n            case 'localStorage':\n                storageProvider = storageUtil.getLocalStorage();\n                break;\n            case 'cookie':\n                storageProvider = storageUtil.getCookieStorage(options);\n                break;\n            case 'memory':\n                storageProvider = storageUtil.getInMemoryStorage();\n                break;\n            default:\n                throw new AuthSdkError(`Unrecognized storage option: ${storageType}`);\n                break;\n        }\n        return storageProvider;\n    },\n    findStorageType: function (types) {\n        let curType;\n        let nextType;\n        types = types.slice(); // copy array\n        curType = types.shift();\n        nextType = types.length ? types[0] : null;\n        if (!nextType) {\n            return curType;\n        }\n        if (storageUtil.testStorageType(curType)) {\n            return curType;\n        }\n        // preferred type was unsupported.\n        warn(`This browser doesn't support ${curType}. Switching to ${nextType}.`);\n        // fallback to the next type. this is a recursive call\n        return storageUtil.findStorageType(types);\n    },\n    getLocalStorage: function () {\n        return localStorage;\n    },\n    getSessionStorage: function () {\n        return sessionStorage;\n    },\n    // Provides webStorage-like interface for cookies\n    getCookieStorage: function (options) {\n        const secure = options.secure;\n        const sameSite = options.sameSite;\n        if (typeof secure === 'undefined' || typeof sameSite === 'undefined') {\n            throw new AuthSdkError('getCookieStorage: \"secure\" and \"sameSite\" options must be provided');\n        }\n        const storage = {\n            getItem: storageUtil.storage.get,\n            setItem: function (key, value, expiresAt) {\n                // By defauilt, cookie shouldn't expire\n                expiresAt = typeof expiresAt === 'undefined' ? '2200-01-01T00:00:00.000Z' : expiresAt;\n                storageUtil.storage.set(key, value, expiresAt, {\n                    secure: secure,\n                    sameSite: sameSite\n                });\n            },\n            removeItem: function (key) {\n                storageUtil.storage.delete(key);\n            }\n        };\n        if (!options.useMultipleCookies) {\n            return storage;\n        }\n        // options.useMultipleCookies - because cookies have size limits.\n        // Can only be used when storing an object value. Object properties will be saved to separate cookies.\n        //  Each property of the object must also be an object.\n        return {\n            getItem: function (key) {\n                var data = storage.getItem(); // read all cookies\n                var value = {};\n                Object.keys(data).forEach(k => {\n                    if (k.indexOf(key) === 0) { // filter out unrelated cookies\n                        value[k.replace(`${key}_`, '')] = JSON.parse(data[k]); // populate with cookie dataa\n                    }\n                });\n                return JSON.stringify(value);\n            },\n            setItem: function (key, value) {\n                var existingValues = JSON.parse(this.getItem(key));\n                value = JSON.parse(value);\n                // Set key-value pairs from input to cookies\n                Object.keys(value).forEach(k => {\n                    var storageKey = key + '_' + k;\n                    var valueToStore = JSON.stringify(value[k]);\n                    storage.setItem(storageKey, valueToStore);\n                    delete existingValues[k];\n                });\n                // Delete unmatched keys from existing cookies\n                Object.keys(existingValues).forEach(k => {\n                    storage.removeItem(key + '_' + k);\n                });\n            },\n            removeItem: function (key) {\n                var existingValues = JSON.parse(this.getItem(key));\n                Object.keys(existingValues).forEach(k => {\n                    storage.removeItem(key + '_' + k);\n                });\n            }\n        };\n    },\n    // Provides an in-memory solution\n    getInMemoryStorage: function () {\n        var store = {};\n        return {\n            getItem: function (key) {\n                return store[key];\n            },\n            setItem: function (key, value) {\n                store[key] = value;\n            }\n        };\n    },\n    testStorage: function (storage) {\n        var key = 'okta-test-storage';\n        try {\n            storage.setItem(key, key);\n            storage.removeItem(key);\n            return true;\n        }\n        catch (e) {\n            return false;\n        }\n    },\n    storage: {\n        set: function (name, value, expiresAt, options) {\n            const secure = options.secure;\n            const sameSite = options.sameSite;\n            if (typeof secure === 'undefined' || typeof sameSite === 'undefined') {\n                throw new AuthSdkError('storage.set: \"secure\" and \"sameSite\" options must be provided');\n            }\n            var cookieOptions = {\n                path: options.path || '/',\n                secure,\n                sameSite\n            };\n            // eslint-disable-next-line no-extra-boolean-cast\n            if (!!(Date.parse(expiresAt))) {\n                // Expires value can be converted to a Date object.\n                //\n                // If the 'expiresAt' value is not provided, or the value cannot be\n                // parsed as a Date object, the cookie will set as a session cookie.\n                cookieOptions.expires = new Date(expiresAt);\n            }\n            Cookies.set(name, value, cookieOptions);\n            return storageUtil.storage.get(name);\n        },\n        get: function (name) {\n            return Cookies.get(name);\n        },\n        delete: function (name) {\n            return Cookies.remove(name, { path: '/' });\n        }\n    }\n};\nexport default storageUtil;\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\n/* global window */\nimport { omit, getLink, toQueryString } from './util';\nimport http from './http';\nfunction sessionExists(sdk) {\n    return sdk.session.get()\n        .then(function (res) {\n        if (res.status === 'ACTIVE') {\n            return true;\n        }\n        return false;\n    })\n        .catch(function () {\n        return false;\n    });\n}\nfunction getSession(sdk) {\n    return http.get(sdk, '/api/v1/sessions/me')\n        .then(function (session) {\n        var res = omit(session, '_links');\n        res.refresh = function () {\n            return http.post(sdk, getLink(session, 'refresh').href);\n        };\n        res.user = function () {\n            return http.get(sdk, getLink(session, 'user').href);\n        };\n        return res;\n    })\n        .catch(function () {\n        // Return INACTIVE status on failure\n        return { status: 'INACTIVE' };\n    });\n}\nfunction closeSession(sdk) {\n    return http.httpRequest(sdk, {\n        url: sdk.getIssuerOrigin() + '/api/v1/sessions/me',\n        method: 'DELETE'\n    });\n}\nfunction refreshSession(sdk) {\n    return http.post(sdk, '/api/v1/sessions/me/lifecycle/refresh');\n}\nfunction setCookieAndRedirect(sdk, sessionToken, redirectUrl) {\n    redirectUrl = redirectUrl || window.location.href;\n    window.location.assign(sdk.getIssuerOrigin() + '/login/sessionCookieRedirect' +\n        toQueryString({\n            checkAccountSetupComplete: true,\n            token: sessionToken,\n            redirectUrl: redirectUrl\n        }));\n}\nexport { sessionExists, getSession, closeSession, refreshSession, setCookieAndRedirect };\n","import { isString, removeNils, toQueryString } from '../../util';\nimport { AuthSdkError } from '../../errors';\nexport function convertTokenParamsToOAuthParams(tokenParams) {\n    // Quick validation\n    if (!tokenParams.clientId) {\n        throw new AuthSdkError('A clientId must be specified in the OktaAuth constructor to get a token');\n    }\n    if (isString(tokenParams.responseType) && tokenParams.responseType.indexOf(' ') !== -1) {\n        throw new AuthSdkError('Multiple OAuth responseTypes must be defined as an array');\n    }\n    // Convert our params to their actual OAuth equivalents\n    var oauthParams = {\n        'client_id': tokenParams.clientId,\n        'code_challenge': tokenParams.codeChallenge,\n        'code_challenge_method': tokenParams.codeChallengeMethod,\n        'display': tokenParams.display,\n        'idp': tokenParams.idp,\n        'idp_scope': tokenParams.idpScope,\n        'login_hint': tokenParams.loginHint,\n        'max_age': tokenParams.maxAge,\n        'nonce': tokenParams.nonce,\n        'prompt': tokenParams.prompt,\n        'redirect_uri': tokenParams.redirectUri,\n        'response_mode': tokenParams.responseMode,\n        'response_type': tokenParams.responseType,\n        'sessionToken': tokenParams.sessionToken,\n        'state': tokenParams.state,\n    };\n    oauthParams = removeNils(oauthParams);\n    ['idp_scope', 'response_type'].forEach(function (mayBeArray) {\n        if (Array.isArray(oauthParams[mayBeArray])) {\n            oauthParams[mayBeArray] = oauthParams[mayBeArray].join(' ');\n        }\n    });\n    if (tokenParams.responseType.indexOf('id_token') !== -1 &&\n        tokenParams.scopes.indexOf('openid') === -1) {\n        throw new AuthSdkError('openid scope must be specified in the scopes argument when requesting an id_token');\n    }\n    else {\n        oauthParams.scope = tokenParams.scopes.join(' ');\n    }\n    return oauthParams;\n}\nexport function buildAuthorizeParams(tokenParams) {\n    var oauthQueryParams = convertTokenParamsToOAuthParams(tokenParams);\n    return toQueryString(oauthQueryParams);\n}\n","import { AuthSdkError } from '../../errors';\nimport { removeNils, toQueryString } from '../../util';\nimport http from '../../http';\nfunction validateOptions(options) {\n    // Quick validation\n    if (!options.clientId) {\n        throw new AuthSdkError('A clientId must be specified in the OktaAuth constructor to get a token');\n    }\n    if (!options.redirectUri) {\n        throw new AuthSdkError('The redirectUri passed to /authorize must also be passed to /token');\n    }\n    if (!options.authorizationCode && !options.interactionCode) {\n        throw new AuthSdkError('An authorization code (returned from /authorize) must be passed to /token');\n    }\n    if (!options.codeVerifier) {\n        throw new AuthSdkError('The \"codeVerifier\" (generated and saved by your app) must be passed to /token');\n    }\n}\nfunction getPostData(options) {\n    // Convert Token params to OAuth params, sent to the /token endpoint\n    var params = removeNils({\n        'client_id': options.clientId,\n        'redirect_uri': options.redirectUri,\n        'grant_type': options.interactionCode ? 'interaction_code' : 'authorization_code',\n        'code_verifier': options.codeVerifier\n    });\n    if (options.interactionCode) {\n        params['interaction_code'] = options.interactionCode;\n    }\n    else if (options.authorizationCode) {\n        params.code = options.authorizationCode;\n    }\n    // Encode as URL string\n    return toQueryString(params).slice(1);\n}\n// exchange authorization code for an access token\nexport function postToTokenEndpoint(sdk, options, urls) {\n    validateOptions(options);\n    var data = getPostData(options);\n    return http.httpRequest(sdk, {\n        url: urls.tokenUrl,\n        method: 'POST',\n        args: data,\n        withCredentials: false,\n        headers: {\n            'Content-Type': 'application/x-www-form-urlencoded'\n        }\n    });\n}\nexport function postRefreshToken(sdk, options, refreshToken) {\n    return http.httpRequest(sdk, {\n        url: refreshToken.tokenUrl,\n        method: 'POST',\n        withCredentials: false,\n        headers: {\n            'Content-Type': 'application/x-www-form-urlencoded',\n        },\n        args: Object.entries({\n            client_id: options.clientId,\n            grant_type: 'refresh_token',\n            scope: refreshToken.scopes.join(' '),\n            refresh_token: refreshToken.refreshToken, // eslint-disable-line camelcase\n        }).map(function ([name, value]) {\n            return name + '=' + encodeURIComponent(value);\n        }).join('&'),\n    });\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport http from '../../http';\nimport { find } from '../../util';\nimport AuthSdkError from '../../errors/AuthSdkError';\nexport function getWellKnown(sdk, issuer) {\n    var authServerUri = (issuer || sdk.options.issuer);\n    return http.get(sdk, authServerUri + '/.well-known/openid-configuration', {\n        cacheResponse: true\n    });\n}\nexport function getKey(sdk, issuer, kid) {\n    var httpCache = sdk.storageManager.getHttpCache(sdk.options.cookies);\n    return getWellKnown(sdk, issuer)\n        .then(function (wellKnown) {\n        var jwksUri = wellKnown['jwks_uri'];\n        // Check our kid against the cached version (if it exists and isn't expired)\n        var cacheContents = httpCache.getStorage();\n        var cachedResponse = cacheContents[jwksUri];\n        if (cachedResponse && Date.now() / 1000 < cachedResponse.expiresAt) {\n            var cachedKey = find(cachedResponse.response.keys, {\n                kid: kid\n            });\n            if (cachedKey) {\n                return cachedKey;\n            }\n        }\n        // Remove cache for the key\n        httpCache.clearStorage(jwksUri);\n        // Pull the latest keys if the key wasn't in the cache\n        return http.get(sdk, jwksUri, {\n            cacheResponse: true\n        })\n            .then(function (res) {\n            var key = find(res.keys, {\n                kid: kid\n            });\n            if (key) {\n                return key;\n            }\n            throw new AuthSdkError('The key id, ' + kid + ', was not found in the server\\'s keys');\n        });\n    });\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\n/* global window, document */\n/* eslint-disable complexity, max-statements */\nimport { AuthSdkError } from '../../errors';\nimport { isIE11OrLess } from '../../util';\nexport function addListener(eventTarget, name, fn) {\n    if (eventTarget.addEventListener) {\n        eventTarget.addEventListener(name, fn);\n    }\n    else {\n        eventTarget.attachEvent('on' + name, fn);\n    }\n}\nexport function removeListener(eventTarget, name, fn) {\n    if (eventTarget.removeEventListener) {\n        eventTarget.removeEventListener(name, fn);\n    }\n    else {\n        eventTarget.detachEvent('on' + name, fn);\n    }\n}\nexport function loadFrame(src) {\n    var iframe = document.createElement('iframe');\n    iframe.style.display = 'none';\n    iframe.src = src;\n    return document.body.appendChild(iframe);\n}\nexport function loadPopup(src, options) {\n    var title = options.popupTitle || 'External Identity Provider User Authentication';\n    var appearance = 'toolbar=no, scrollbars=yes, resizable=yes, ' +\n        'top=100, left=500, width=600, height=600';\n    if (isIE11OrLess()) {\n        // IE<=11 doesn't fully support postMessage at time of writting.\n        // the following simple solution happened to solve the issue\n        // without adding another proxy layer which makes flow more complecated.\n        var winEl = window.open('/', title, appearance);\n        winEl.location.href = src;\n        return winEl;\n    }\n    else {\n        return window.open(src, title, appearance);\n    }\n}\nexport function addPostMessageListener(sdk, timeout, state) {\n    var responseHandler;\n    var timeoutId;\n    var msgReceivedOrTimeout = new Promise(function (resolve, reject) {\n        responseHandler = function responseHandler(e) {\n            if (!e.data || e.data.state !== state) {\n                // A message not meant for us\n                return;\n            }\n            // Configuration mismatch between saved token and current app instance\n            // This may happen if apps with different issuers are running on the same host url\n            // If they share the same storage key, they may read and write tokens in the same location.\n            // Common when developing against http://localhost\n            if (e.origin !== sdk.getIssuerOrigin()) {\n                return reject(new AuthSdkError('The request does not match client configuration'));\n            }\n            resolve(e.data);\n        };\n        addListener(window, 'message', responseHandler);\n        timeoutId = setTimeout(function () {\n            reject(new AuthSdkError('OAuth flow timed out'));\n        }, timeout || 120000);\n    });\n    return msgReceivedOrTimeout\n        .finally(function () {\n        clearTimeout(timeoutId);\n        removeListener(window, 'message', responseHandler);\n    });\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\n/* eslint-disable complexity, max-statements */\nimport { genRandomString, removeTrailingSlash } from '../../util';\nimport AuthSdkError from '../../errors/AuthSdkError';\nexport function generateState() {\n    return genRandomString(64);\n}\nexport function generateNonce() {\n    return genRandomString(64);\n}\nexport function getOAuthUrls(sdk, options) {\n    if (arguments.length > 2) {\n        throw new AuthSdkError('As of version 3.0, \"getOAuthUrls\" takes only a single set of options');\n    }\n    options = options || {};\n    // Get user-supplied arguments\n    var authorizeUrl = removeTrailingSlash(options.authorizeUrl) || sdk.options.authorizeUrl;\n    var issuer = removeTrailingSlash(options.issuer) || sdk.options.issuer;\n    var userinfoUrl = removeTrailingSlash(options.userinfoUrl) || sdk.options.userinfoUrl;\n    var tokenUrl = removeTrailingSlash(options.tokenUrl) || sdk.options.tokenUrl;\n    var logoutUrl = removeTrailingSlash(options.logoutUrl) || sdk.options.logoutUrl;\n    var revokeUrl = removeTrailingSlash(options.revokeUrl) || sdk.options.revokeUrl;\n    var baseUrl = issuer.indexOf('/oauth2') > 0 ? issuer : issuer + '/oauth2';\n    authorizeUrl = authorizeUrl || baseUrl + '/v1/authorize';\n    userinfoUrl = userinfoUrl || baseUrl + '/v1/userinfo';\n    tokenUrl = tokenUrl || baseUrl + '/v1/token';\n    revokeUrl = revokeUrl || baseUrl + '/v1/revoke';\n    logoutUrl = logoutUrl || baseUrl + '/v1/logout';\n    return {\n        issuer: issuer,\n        authorizeUrl: authorizeUrl,\n        userinfoUrl: userinfoUrl,\n        tokenUrl: tokenUrl,\n        revokeUrl: revokeUrl,\n        logoutUrl: logoutUrl\n    };\n}\n","/* global window */\n/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport { generateNonce, generateState } from './oauth';\nexport function getDefaultTokenParams(sdk) {\n    const { pkce, clientId, redirectUri, responseType, responseMode, scopes, state, ignoreSignature } = sdk.options;\n    return {\n        pkce,\n        clientId,\n        redirectUri: redirectUri || window.location.href,\n        responseType: responseType || ['token', 'id_token'],\n        responseMode,\n        state: state || generateState(),\n        nonce: generateNonce(),\n        scopes: scopes || ['openid', 'email'],\n        ignoreSignature\n    };\n}\n","export function isInteractionRequiredError(error) {\n    if (error.name !== 'OAuthError') {\n        return false;\n    }\n    const oauthError = error;\n    return (oauthError.errorCode === 'interaction_required');\n}\nexport function isAuthorizationCodeError(sdk, error) {\n    if (error.name !== 'AuthApiError') {\n        return false;\n    }\n    const authApiError = error;\n    // xhr property doesn't seem to match XMLHttpRequest type\n    const errorResponse = authApiError.xhr;\n    const responseJSON = errorResponse === null || errorResponse === void 0 ? void 0 : errorResponse.responseJSON;\n    return sdk.options.pkce && ((responseJSON === null || responseJSON === void 0 ? void 0 : responseJSON.error) === 'invalid_grant');\n}\n","export function hasTokensInHash(hash) {\n    return /((id|access)_token=)/i.test(hash);\n}\n// authorization_code\nexport function hasAuthorizationCode(hashOrSearch) {\n    return /(code=)/i.test(hashOrSearch);\n}\n// interaction_code\nexport function hasInteractionCode(hashOrSearch) {\n    return /(interaction_code=)/i.test(hashOrSearch);\n}\nexport function hasErrorInUrl(hashOrSearch) {\n    return /(error=)/i.test(hashOrSearch) || /(error_description)/i.test(hashOrSearch);\n}\nexport function isRedirectUri(uri, sdk) {\n    var authParams = sdk.options;\n    return uri && uri.indexOf(authParams.redirectUri) === 0;\n}\nexport function isCodeFlow(options) {\n    return options.pkce || options.responseType === 'code' || options.responseMode === 'query';\n}\nexport function getHashOrSearch(options) {\n    var codeFlow = isCodeFlow(options);\n    var useQuery = codeFlow && options.responseMode !== 'fragment';\n    return useQuery ? window.location.search : window.location.hash;\n}\n/**\n * Check if tokens or a code have been passed back into the url, which happens in\n * the OIDC (including social auth IDP) redirect flow.\n */\nexport function isLoginRedirect(sdk) {\n    // First check, is this a redirect URI?\n    if (!isRedirectUri(window.location.href, sdk)) {\n        return false;\n    }\n    // The location contains either a code, token, or an error + error_description\n    var codeFlow = isCodeFlow(sdk.options);\n    var hashOrSearch = getHashOrSearch(sdk.options);\n    if (hasErrorInUrl(hashOrSearch)) {\n        return true;\n    }\n    if (codeFlow) {\n        var hasCode = hasAuthorizationCode(hashOrSearch) || hasInteractionCode(hashOrSearch);\n        return hasCode;\n    }\n    // implicit flow, will always be hash fragment\n    return hasTokensInHash(window.location.hash);\n}\n/**\n * Check if error=interaction_required has been passed back in the url, which happens in\n * the social auth IDP redirect flow.\n */\nexport function isInteractionRequired(sdk) {\n    // First check, is this a redirect URI?\n    if (!isLoginRedirect(sdk)) {\n        return false;\n    }\n    var hashOrSearch = getHashOrSearch(sdk.options);\n    return /(error=interaction_required)/i.test(hashOrSearch);\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport { getWellKnown } from '../endpoints/well-known';\nimport { AuthSdkError } from '../../errors';\nimport { clone } from '../../util';\nimport { getDefaultTokenParams } from './defaultTokenParams';\nimport { DEFAULT_CODE_CHALLENGE_METHOD } from '../../constants';\nimport pkce from './pkce';\n// Prepares params for a call to /authorize or /token\nexport function prepareTokenParams(sdk, tokenParams) {\n    // build params using defaults + options\n    const defaults = getDefaultTokenParams(sdk);\n    tokenParams = Object.assign({}, defaults, clone(tokenParams));\n    if (tokenParams.pkce === false) {\n        // Implicit flow or authorization_code without PKCE\n        return Promise.resolve(tokenParams);\n    }\n    // PKCE flow\n    if (!sdk.features.isPKCESupported()) {\n        var errorMessage = 'PKCE requires a modern browser with encryption support running in a secure context.';\n        if (!sdk.features.isHTTPS()) {\n            // eslint-disable-next-line max-len\n            errorMessage += '\\nThe current page is not being served with HTTPS protocol. PKCE requires secure HTTPS protocol.';\n        }\n        if (!sdk.features.hasTextEncoder()) {\n            // eslint-disable-next-line max-len\n            errorMessage += '\\n\"TextEncoder\" is not defined. To use PKCE, you may need to include a polyfill/shim for this browser.';\n        }\n        return Promise.reject(new AuthSdkError(errorMessage));\n    }\n    // set default code challenge method, if none provided\n    if (!tokenParams.codeChallengeMethod) {\n        tokenParams.codeChallengeMethod = DEFAULT_CODE_CHALLENGE_METHOD;\n    }\n    // responseType is forced\n    tokenParams.responseType = 'code';\n    return getWellKnown(sdk, null)\n        .then(function (res) {\n        var methods = res['code_challenge_methods_supported'] || [];\n        if (methods.indexOf(tokenParams.codeChallengeMethod) === -1) {\n            throw new AuthSdkError('Invalid code_challenge_method');\n        }\n    })\n        .then(function () {\n        if (!tokenParams.codeVerifier) {\n            tokenParams.codeVerifier = pkce.generateVerifier();\n        }\n        return pkce.computeChallenge(tokenParams.codeVerifier);\n    })\n        .then(function (codeChallenge) {\n        // Clone/copy the params. Set codeChallenge\n        var clonedParams = clone(tokenParams) || {};\n        Object.assign(clonedParams, tokenParams, {\n            codeChallenge: codeChallenge,\n        });\n        return clonedParams;\n    });\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\n/* eslint-disable complexity, max-statements */\nexport function urlParamsToObject(hashOrSearch) {\n    // Predefine regexs for parsing hash\n    var plus2space = /\\+/g;\n    var paramSplit = /([^&=]+)=?([^&]*)/g;\n    var fragment = hashOrSearch;\n    // Some hash based routers will automatically add a / character after the hash\n    if (fragment.charAt(0) === '#' && fragment.charAt(1) === '/') {\n        fragment = fragment.substring(2);\n    }\n    // Remove the leading # or ?\n    if (fragment.charAt(0) === '#' || fragment.charAt(0) === '?') {\n        fragment = fragment.substring(1);\n    }\n    var obj = {};\n    // Loop until we have no more params\n    var param;\n    while (true) { // eslint-disable-line no-constant-condition\n        param = paramSplit.exec(fragment);\n        if (!param) {\n            break;\n        }\n        var key = param[1];\n        var value = param[2];\n        // id_token should remain base64url encoded\n        if (key === 'id_token' || key === 'access_token' || key === 'code') {\n            obj[key] = value;\n        }\n        else {\n            obj[key] = decodeURIComponent(value.replace(plus2space, ' '));\n        }\n    }\n    return obj;\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\n/* eslint-disable complexity, max-statements */\nimport AuthSdkError from '../../errors/AuthSdkError';\nexport function validateClaims(sdk, claims, validationParams) {\n    var aud = validationParams.clientId;\n    var iss = validationParams.issuer;\n    var nonce = validationParams.nonce;\n    if (!claims || !iss || !aud) {\n        throw new AuthSdkError('The jwt, iss, and aud arguments are all required');\n    }\n    if (nonce && claims.nonce !== nonce) {\n        throw new AuthSdkError('OAuth flow response nonce doesn\\'t match request nonce');\n    }\n    var now = Math.floor(Date.now() / 1000);\n    if (claims.iss !== iss) {\n        throw new AuthSdkError('The issuer [' + claims.iss + '] ' +\n            'does not match [' + iss + ']');\n    }\n    if (claims.aud !== aud) {\n        throw new AuthSdkError('The audience [' + claims.aud + '] ' +\n            'does not match [' + aud + ']');\n    }\n    if (claims.iat > claims.exp) {\n        throw new AuthSdkError('The JWT expired before it was issued');\n    }\n    if ((now - sdk.options.maxClockSkew) > claims.exp) {\n        throw new AuthSdkError('The JWT expired and is no longer valid');\n    }\n    if (claims.iat > (now + sdk.options.maxClockSkew)) {\n        throw new AuthSdkError('The JWT was issued in the future');\n    }\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport { AuthSdkError } from '../errors';\nimport { base64UrlToString } from '../util';\nexport function decodeToken(token) {\n    var jwt = token.split('.');\n    var decodedToken;\n    try {\n        decodedToken = {\n            header: JSON.parse(base64UrlToString(jwt[0])),\n            payload: JSON.parse(base64UrlToString(jwt[1])),\n            signature: jwt[2]\n        };\n    }\n    catch (e) {\n        throw new AuthSdkError('Malformed token');\n    }\n    return decodedToken;\n}\n","/* global btoa */\n/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport http from '../http';\nimport { toQueryString } from '../util';\nimport { getOAuthUrls, } from './util/oauth';\nimport AuthSdkError from '../errors/AuthSdkError';\n// refresh tokens have precedence to be revoked if no token is specified\nexport function revokeToken(sdk, token) {\n    return Promise.resolve()\n        .then(function () {\n        var accessToken;\n        var refreshToken;\n        if (token) {\n            accessToken = token.accessToken;\n            refreshToken = token.refreshToken;\n        }\n        if (!accessToken && !refreshToken) {\n            throw new AuthSdkError('A valid access or refresh token object is required');\n        }\n        var clientId = sdk.options.clientId;\n        if (!clientId) {\n            throw new AuthSdkError('A clientId must be specified in the OktaAuth constructor to revoke a token');\n        }\n        var revokeUrl = getOAuthUrls(sdk).revokeUrl;\n        var args = toQueryString({\n            // eslint-disable-next-line camelcase\n            token_type_hint: refreshToken ? 'refresh_token' : 'access_token',\n            token: refreshToken || accessToken,\n        }).slice(1);\n        var creds = btoa(clientId);\n        return http.post(sdk, revokeUrl, args, {\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded',\n                'Authorization': 'Basic ' + creds\n            }\n        });\n    });\n}\n","/* eslint-disable max-len */\n/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport { getOAuthUrls } from '../oidc';\nimport { getDefaultTokenParams } from './util';\nimport { clone } from '../util';\nimport { postToTokenEndpoint } from './endpoints/token';\nimport { handleOAuthResponse } from './handleOAuthResponse';\n// codeVerifier is required. May pass either an authorizationCode or interactionCode\nexport function exchangeCodeForTokens(sdk, tokenParams, urls) {\n    urls = urls || getOAuthUrls(sdk, tokenParams);\n    // build params using defaults + options\n    tokenParams = Object.assign({}, getDefaultTokenParams(sdk), clone(tokenParams));\n    const { authorizationCode, interactionCode, codeVerifier, clientId, redirectUri, scopes, ignoreSignature, } = tokenParams;\n    var getTokenOptions = {\n        clientId,\n        redirectUri,\n        authorizationCode,\n        interactionCode,\n        codeVerifier,\n    };\n    return postToTokenEndpoint(sdk, getTokenOptions, urls)\n        .then((response) => {\n        // `handleOAuthResponse` hanadles responses from both `/authorize` and `/token` endpoints\n        // Here we modify the response from `/token` so that it more closely matches a response from `/authorize`\n        // `responseType` is used to validate that the expected tokens were returned\n        const responseType = ['token']; // an accessToken will always be returned\n        if (scopes.indexOf('openid') !== -1) {\n            responseType.push('id_token'); // an idToken will be returned if \"openid\" is in the scopes\n        }\n        const handleResponseOptions = {\n            clientId,\n            redirectUri,\n            scopes,\n            responseType,\n            ignoreSignature,\n        };\n        return handleOAuthResponse(sdk, handleResponseOptions, response, urls)\n            .then((response) => {\n            // For compatibility, \"code\" is returned in the TokenResponse. OKTA-326091\n            response.code = authorizationCode;\n            return response;\n        });\n    });\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n/* global crypto */\nimport { stringToBase64Url, clone, stringToBuffer, base64UrlDecode } from './util';\nfunction getOidcHash(str) {\n    var buffer = new TextEncoder().encode(str);\n    return crypto.subtle.digest('SHA-256', buffer).then(function (arrayBuffer) {\n        var intBuffer = new Uint8Array(arrayBuffer);\n        var firstHalf = intBuffer.slice(0, 16);\n        var hash = String.fromCharCode.apply(null, firstHalf);\n        var b64u = stringToBase64Url(hash); // url-safe base64 variant\n        return b64u;\n    });\n}\nfunction verifyToken(idToken, key) {\n    key = clone(key);\n    var format = 'jwk';\n    var algo = {\n        name: 'RSASSA-PKCS1-v1_5',\n        hash: { name: 'SHA-256' }\n    };\n    var extractable = true;\n    var usages = ['verify'];\n    // https://connect.microsoft.com/IE/feedback/details/2242108/webcryptoapi-importing-jwk-with-use-field-fails\n    // This is a metadata tag that specifies the intent of how the key should be used.\n    // It's not necessary to properly verify the jwt's signature.\n    delete key.use;\n    // @ts-ignore\n    return crypto.subtle.importKey(format, key, algo, extractable, usages)\n        .then(function (cryptoKey) {\n        var jwt = idToken.split('.');\n        var payload = stringToBuffer(jwt[0] + '.' + jwt[1]);\n        var b64Signature = base64UrlDecode(jwt[2]);\n        var signature = stringToBuffer(b64Signature);\n        return crypto.subtle.verify(algo, cryptoKey, signature, payload);\n    });\n}\nexport { getOidcHash, verifyToken };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n/* eslint-disable max-len */\n/* eslint-disable complexity */\n/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport { getWellKnown, getKey } from './endpoints/well-known';\nimport { validateClaims } from './util';\nimport { AuthSdkError } from '../errors';\nimport { decodeToken } from './decodeToken';\nimport * as sdkCrypto from '../crypto';\n// Verify the id token\nexport function verifyToken(sdk, token, validationParams) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (!token || !token.idToken) {\n            throw new AuthSdkError('Only idTokens may be verified');\n        }\n        // Decode the Jwt object (may throw)\n        var jwt = decodeToken(token.idToken);\n        var openIdConfig = yield getWellKnown(sdk); // using sdk.options.issuer\n        var validationOptions = {\n            issuer: openIdConfig.issuer,\n            clientId: sdk.options.clientId,\n            ignoreSignature: sdk.options.ignoreSignature\n        };\n        Object.assign(validationOptions, validationParams);\n        // Standard claim validation (may throw)\n        validateClaims(sdk, jwt.payload, validationOptions);\n        // If the browser doesn't support native crypto or we choose not\n        // to verify the signature, bail early\n        if (validationOptions.ignoreSignature == true || !sdk.features.isTokenVerifySupported()) {\n            return token;\n        }\n        const key = yield getKey(sdk, token.issuer, jwt.header.kid);\n        const valid = yield sdkCrypto.verifyToken(token.idToken, key);\n        if (!valid) {\n            throw new AuthSdkError('The token signature is not valid');\n        }\n        if (validationParams && validationParams.accessToken && token.claims.at_hash) {\n            const hash = yield sdkCrypto.getOidcHash(validationParams.accessToken);\n            if (hash !== token.claims.at_hash) {\n                throw new AuthSdkError('Token hash verification failed');\n            }\n        }\n        return token;\n    });\n}\n","/* eslint-disable complexity, max-statements */\n/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport { clone } from '../util';\nimport { getOAuthUrls, } from './util/oauth';\nimport { AuthSdkError, OAuthError } from '../errors';\nimport { exchangeCodeForTokens } from './exchangeCodeForTokens';\nimport { verifyToken } from './verifyToken';\nimport { getDefaultTokenParams } from '.';\nfunction validateResponse(res, oauthParams) {\n    if (res['error'] || res['error_description']) {\n        throw new OAuthError(res['error'], res['error_description']);\n    }\n    if (res.state !== oauthParams.state) {\n        throw new AuthSdkError('OAuth flow response state doesn\\'t match request state');\n    }\n}\n// eslint-disable-next-line max-len\nexport function handleOAuthResponse(sdk, tokenParams, res, urls) {\n    var pkce = sdk.options.pkce !== false;\n    // The result contains an authorization_code and PKCE is enabled \n    // `exchangeCodeForTokens` will call /token then call `handleOauthResponse` recursively with the result\n    if (pkce && (res.code || res.interaction_code)) {\n        return exchangeCodeForTokens(sdk, Object.assign({}, tokenParams, {\n            authorizationCode: res.code,\n            interactionCode: res.interaction_code\n        }), urls);\n    }\n    tokenParams = tokenParams || getDefaultTokenParams(sdk);\n    urls = urls || getOAuthUrls(sdk, tokenParams);\n    var responseType = tokenParams.responseType;\n    if (!Array.isArray(responseType)) {\n        responseType = [responseType];\n    }\n    var scopes;\n    if (res.scope) {\n        scopes = res.scope.split(' ');\n    }\n    else {\n        scopes = clone(tokenParams.scopes);\n    }\n    var clientId = tokenParams.clientId || sdk.options.clientId;\n    // Handling the result from implicit flow or PKCE token exchange\n    return Promise.resolve()\n        .then(function () {\n        validateResponse(res, tokenParams);\n    }).then(function () {\n        var tokenDict = {};\n        var expiresIn = res.expires_in;\n        var tokenType = res.token_type;\n        var accessToken = res.access_token;\n        var idToken = res.id_token;\n        var refreshToken = res.refresh_token;\n        if (accessToken) {\n            var accessJwt = sdk.token.decode(accessToken);\n            tokenDict.accessToken = {\n                value: accessToken,\n                accessToken: accessToken,\n                claims: accessJwt.payload,\n                expiresAt: Number(expiresIn) + Math.floor(Date.now() / 1000),\n                tokenType: tokenType,\n                scopes: scopes,\n                authorizeUrl: urls.authorizeUrl,\n                userinfoUrl: urls.userinfoUrl\n            };\n        }\n        if (refreshToken) {\n            tokenDict.refreshToken = {\n                value: refreshToken,\n                refreshToken: refreshToken,\n                expiresAt: Number(expiresIn) + Math.floor(Date.now() / 1000),\n                scopes: scopes,\n                tokenUrl: urls.tokenUrl,\n                authorizeUrl: urls.authorizeUrl,\n                issuer: urls.issuer,\n            };\n        }\n        if (idToken) {\n            var idJwt = sdk.token.decode(idToken);\n            var idTokenObj = {\n                value: idToken,\n                idToken: idToken,\n                claims: idJwt.payload,\n                expiresAt: idJwt.payload.exp,\n                scopes: scopes,\n                authorizeUrl: urls.authorizeUrl,\n                issuer: urls.issuer,\n                clientId: clientId\n            };\n            var validationParams = {\n                clientId: clientId,\n                issuer: urls.issuer,\n                nonce: tokenParams.nonce,\n                accessToken: accessToken\n            };\n            if (tokenParams.ignoreSignature !== undefined) {\n                validationParams.ignoreSignature = tokenParams.ignoreSignature;\n            }\n            return verifyToken(sdk, idTokenObj, validationParams)\n                .then(function () {\n                tokenDict.idToken = idTokenObj;\n                return tokenDict;\n            });\n        }\n        return tokenDict;\n    })\n        .then(function (tokenDict) {\n        // Validate received tokens against requested response types \n        if (responseType.indexOf('token') !== -1 && !tokenDict.accessToken) {\n            // eslint-disable-next-line max-len\n            throw new AuthSdkError('Unable to parse OAuth flow response: response type \"token\" was requested but \"access_token\" was not returned.');\n        }\n        if (responseType.indexOf('id_token') !== -1 && !tokenDict.idToken) {\n            // eslint-disable-next-line max-len\n            throw new AuthSdkError('Unable to parse OAuth flow response: response type \"id_token\" was requested but \"id_token\" was not returned.');\n        }\n        return {\n            tokens: tokenDict,\n            state: res.state,\n            code: res.code\n        };\n    });\n}\n","/* global document */\n/* eslint-disable complexity, max-statements */\n/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport { getOAuthUrls, loadFrame, loadPopup, } from './util';\nimport AuthSdkError from '../errors/AuthSdkError';\nimport { prepareTokenParams } from './util/prepareTokenParams';\nimport { buildAuthorizeParams } from './endpoints/authorize';\nimport { addPostMessageListener } from './util';\nimport { handleOAuthResponse } from './handleOAuthResponse';\n/*\n * Retrieve an idToken from an Okta or a third party idp\n *\n * Two main flows:\n *\n *  1) Exchange a sessionToken for a token\n *\n *    Required:\n *      clientId: passed via the OktaAuth constructor or into getToken\n *      sessionToken: 'yourtoken'\n *\n *    Optional:\n *      redirectUri: defaults to window.location.href\n *      scopes: defaults to ['openid', 'email']\n *\n *    Forced:\n *      prompt: 'none'\n *      responseMode: 'okta_post_message'\n *      display: undefined\n *\n *  2) Get a token from an idp\n *\n *    Required:\n *      clientId: passed via the OktaAuth constructor or into getToken\n *\n *    Optional:\n *      redirectUri: defaults to window.location.href\n *      scopes: defaults to ['openid', 'email']\n *      idp: defaults to Okta as an idp\n *      prompt: no default. Pass 'none' to throw an error if user is not signed in\n *\n *    Forced:\n *      display: 'popup'\n *\n *  Only common optional params shown. Any OAuth parameters not explicitly forced are available to override\n *\n * @param {Object} oauthOptions\n * @param {String} [oauthOptions.clientId] ID of this client\n * @param {String} [oauthOptions.redirectUri] URI that the iframe or popup will go to once authenticated\n * @param {String[]} [oauthOptions.scopes] OAuth 2.0 scopes to request (openid must be specified)\n * @param {String} [oauthOptions.idp] ID of an external IdP to use for user authentication\n * @param {String} [oauthOptions.sessionToken] Bootstrap Session Token returned by the Okta Authentication API\n * @param {String} [oauthOptions.prompt] Determines whether the Okta login will be displayed on failure.\n *                                       Use 'none' to prevent this behavior\n *\n * @param {Object} options\n * @param {Integer} [options.timeout] Time in ms before the flow is automatically terminated. Defaults to 120000\n * @param {String} [options.popupTitle] Title dispayed in the popup.\n *                                      Defaults to 'External Identity Provider User Authentication'\n */\nexport function getToken(sdk, options) {\n    if (arguments.length > 2) {\n        return Promise.reject(new AuthSdkError('As of version 3.0, \"getToken\" takes only a single set of options'));\n    }\n    options = options || {};\n    return prepareTokenParams(sdk, options)\n        .then(function (tokenParams) {\n        // Start overriding any options that don't make sense\n        var sessionTokenOverrides = {\n            prompt: 'none',\n            responseMode: 'okta_post_message',\n            display: null\n        };\n        var idpOverrides = {\n            display: 'popup'\n        };\n        if (options.sessionToken) {\n            Object.assign(tokenParams, sessionTokenOverrides);\n        }\n        else if (options.idp) {\n            Object.assign(tokenParams, idpOverrides);\n        }\n        // Use the query params to build the authorize url\n        var requestUrl, endpoint, urls;\n        // Get authorizeUrl and issuer\n        urls = getOAuthUrls(sdk, tokenParams);\n        endpoint = options.codeVerifier ? urls.tokenUrl : urls.authorizeUrl;\n        requestUrl = endpoint + buildAuthorizeParams(tokenParams);\n        // Determine the flow type\n        var flowType;\n        if (tokenParams.sessionToken || tokenParams.display === null) {\n            flowType = 'IFRAME';\n        }\n        else if (tokenParams.display === 'popup') {\n            flowType = 'POPUP';\n        }\n        else {\n            flowType = 'IMPLICIT';\n        }\n        // Execute the flow type\n        switch (flowType) {\n            case 'IFRAME':\n                var iframePromise = addPostMessageListener(sdk, options.timeout, tokenParams.state);\n                var iframeEl = loadFrame(requestUrl);\n                return iframePromise\n                    .then(function (res) {\n                    return handleOAuthResponse(sdk, tokenParams, res, urls);\n                })\n                    .finally(function () {\n                    if (document.body.contains(iframeEl)) {\n                        iframeEl.parentElement.removeChild(iframeEl);\n                    }\n                });\n            case 'POPUP':\n                var oauthPromise; // resolves with OAuth response\n                // Add listener on postMessage before window creation, so\n                // postMessage isn't triggered before we're listening\n                if (tokenParams.responseMode === 'okta_post_message') {\n                    if (!sdk.features.isPopupPostMessageSupported()) {\n                        throw new AuthSdkError('This browser doesn\\'t have full postMessage support');\n                    }\n                    oauthPromise = addPostMessageListener(sdk, options.timeout, tokenParams.state);\n                }\n                // Create the window\n                var windowOptions = {\n                    popupTitle: options.popupTitle\n                };\n                var windowEl = loadPopup(requestUrl, windowOptions);\n                // The popup may be closed without receiving an OAuth response. Setup a poller to monitor the window.\n                var popupPromise = new Promise(function (resolve, reject) {\n                    var closePoller = setInterval(function () {\n                        if (!windowEl || windowEl.closed) {\n                            clearInterval(closePoller);\n                            reject(new AuthSdkError('Unable to parse OAuth flow response'));\n                        }\n                    }, 100);\n                    // Proxy the OAuth promise results\n                    oauthPromise\n                        .then(function (res) {\n                        clearInterval(closePoller);\n                        resolve(res);\n                    })\n                        .catch(function (err) {\n                        clearInterval(closePoller);\n                        reject(err);\n                    });\n                });\n                return popupPromise\n                    .then(function (res) {\n                    return handleOAuthResponse(sdk, tokenParams, res, urls);\n                })\n                    .finally(function () {\n                    if (windowEl && !windowEl.closed) {\n                        windowEl.close();\n                    }\n                });\n            default:\n                throw new AuthSdkError('The full page redirect flow is not supported');\n        }\n    });\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport { AuthSdkError } from '../errors';\nimport { clone } from '../util';\nimport { getToken } from './getToken';\nexport function getWithoutPrompt(sdk, options) {\n    if (arguments.length > 2) {\n        return Promise.reject(new AuthSdkError('As of version 3.0, \"getWithoutPrompt\" takes only a single set of options'));\n    }\n    options = clone(options) || {};\n    Object.assign(options, {\n        prompt: 'none',\n        responseMode: 'okta_post_message',\n        display: null\n    });\n    return getToken(sdk, options);\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport { AuthSdkError } from '../errors';\nimport { isToken, isAccessToken, isIDToken } from '../types';\nimport { getWithoutPrompt } from './getWithoutPrompt';\nexport function renewToken(sdk, token) {\n    // Note: This is not used when a refresh token is present\n    if (!isToken(token)) {\n        return Promise.reject(new AuthSdkError('Renew must be passed a token with ' +\n            'an array of scopes and an accessToken or idToken'));\n    }\n    var responseType;\n    if (sdk.options.pkce) {\n        responseType = 'code';\n    }\n    else if (isAccessToken(token)) {\n        responseType = 'token';\n    }\n    else {\n        responseType = 'id_token';\n    }\n    const { scopes, authorizeUrl, userinfoUrl, issuer } = token;\n    return getWithoutPrompt(sdk, {\n        responseType,\n        scopes,\n        authorizeUrl,\n        userinfoUrl,\n        issuer\n    })\n        .then(function (res) {\n        // Multiple tokens may have come back. Return only the token which was requested.\n        var tokens = res.tokens;\n        return isIDToken(token) ? tokens.idToken : tokens.accessToken;\n    });\n}\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport { AuthSdkError } from '../errors';\nimport { getOAuthUrls } from './util/oauth';\nimport { handleOAuthResponse } from './handleOAuthResponse';\nimport { postRefreshToken } from './endpoints/token';\nexport function renewTokensWithRefresh(sdk, tokenParams, refreshTokenObject) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const { clientId } = sdk.options;\n        if (!clientId) {\n            throw new AuthSdkError('A clientId must be specified in the OktaAuth constructor to renew tokens');\n        }\n        const renewTokenParams = Object.assign({}, tokenParams, {\n            clientId,\n        });\n        const tokenResponse = yield postRefreshToken(sdk, renewTokenParams, refreshTokenObject);\n        const urls = getOAuthUrls(sdk, tokenParams);\n        const { tokens } = yield handleOAuthResponse(sdk, renewTokenParams, tokenResponse, urls);\n        return tokens;\n    });\n}\n","import { getWithoutPrompt } from './getWithoutPrompt';\nimport { renewTokensWithRefresh } from './renewTokensWithRefresh';\nimport { getDefaultTokenParams } from './util';\nexport function renewTokens(sdk, options) {\n    // If we have a refresh token, renew using that, otherwise getWithoutPrompt\n    // Calling via async as auth-js doesn't yet (as of 4.2) ensure that updateAuthState() was ever called\n    return sdk.tokenManager.getTokens()\n        .then(tokens => tokens.refreshToken)\n        .then(refreshTokenObject => {\n        if (refreshTokenObject) {\n            return renewTokensWithRefresh(sdk, options, refreshTokenObject);\n        }\n        options = Object.assign({\n            scopes: sdk.options.scopes,\n            authorizeUrl: sdk.options.authorizeUrl,\n            userinfoUrl: sdk.options.userinfoUrl,\n            issuer: sdk.options.issuer\n        }, options);\n        if (sdk.options.pkce) {\n            options.responseType = 'code';\n        }\n        else {\n            const { responseType } = getDefaultTokenParams(sdk);\n            options.responseType = responseType;\n        }\n        return getWithoutPrompt(sdk, options)\n            .then(res => res.tokens);\n    });\n}\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n/* eslint-disable complexity */\n/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport { isFunction } from '../util';\nimport { AuthSdkError, OAuthError } from '../errors';\nimport http from '../http';\nimport { isAccessToken, isIDToken } from '../types';\nexport function getUserInfo(sdk, accessTokenObject, idTokenObject) {\n    return __awaiter(this, void 0, void 0, function* () {\n        // If token objects were not passed, attempt to read from the TokenManager\n        if (!accessTokenObject) {\n            accessTokenObject = (yield sdk.tokenManager.getTokens()).accessToken;\n        }\n        if (!idTokenObject) {\n            idTokenObject = (yield sdk.tokenManager.getTokens()).idToken;\n        }\n        if (!accessTokenObject || !isAccessToken(accessTokenObject)) {\n            return Promise.reject(new AuthSdkError('getUserInfo requires an access token object'));\n        }\n        if (!idTokenObject || !isIDToken(idTokenObject)) {\n            return Promise.reject(new AuthSdkError('getUserInfo requires an ID token object'));\n        }\n        return http.httpRequest(sdk, {\n            url: accessTokenObject.userinfoUrl,\n            method: 'GET',\n            accessToken: accessTokenObject.accessToken\n        })\n            .then(userInfo => {\n            // Only return the userinfo response if subjects match to mitigate token substitution attacks\n            if (userInfo.sub === idTokenObject.claims.sub) {\n                return userInfo;\n            }\n            return Promise.reject(new AuthSdkError('getUserInfo request was rejected due to token mismatch'));\n        })\n            .catch(function (err) {\n            if (err.xhr && (err.xhr.status === 401 || err.xhr.status === 403)) {\n                var authenticateHeader;\n                if (err.xhr.headers && isFunction(err.xhr.headers.get) && err.xhr.headers.get('WWW-Authenticate')) {\n                    authenticateHeader = err.xhr.headers.get('WWW-Authenticate');\n                }\n                else if (isFunction(err.xhr.getResponseHeader)) {\n                    authenticateHeader = err.xhr.getResponseHeader('WWW-Authenticate');\n                }\n                if (authenticateHeader) {\n                    var errorMatches = authenticateHeader.match(/error=\"(.*?)\"/) || [];\n                    var errorDescriptionMatches = authenticateHeader.match(/error_description=\"(.*?)\"/) || [];\n                    var error = errorMatches[1];\n                    var errorDescription = errorDescriptionMatches[1];\n                    if (error && errorDescription) {\n                        err = new OAuthError(error, errorDescription);\n                    }\n                }\n            }\n            throw err;\n        });\n    });\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport { AuthSdkError } from '../errors';\nimport { clone } from '../util';\nimport { getToken } from './getToken';\nexport function getWithPopup(sdk, options) {\n    if (arguments.length > 2) {\n        return Promise.reject(new AuthSdkError('As of version 3.0, \"getWithPopup\" takes only a single set of options'));\n    }\n    options = clone(options) || {};\n    Object.assign(options, {\n        display: 'popup',\n        responseMode: 'okta_post_message'\n    });\n    return getToken(sdk, options);\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport { AuthSdkError } from '../errors';\nimport { clone } from '../util';\nimport { getOAuthUrls, prepareTokenParams } from './util';\nimport { buildAuthorizeParams } from './endpoints/authorize';\nexport function getWithRedirect(sdk, options) {\n    if (arguments.length > 2) {\n        return Promise.reject(new AuthSdkError('As of version 3.0, \"getWithRedirect\" takes only a single set of options'));\n    }\n    options = clone(options) || {};\n    return prepareTokenParams(sdk, options)\n        .then(function (tokenParams) {\n        var urls = getOAuthUrls(sdk, options);\n        var requestUrl = urls.authorizeUrl + buildAuthorizeParams(tokenParams);\n        // Gather the values we want to save in the transaction\n        const { responseType, state, nonce, scopes, clientId, ignoreSignature, redirectUri, codeVerifier, codeChallenge, codeChallengeMethod, } = tokenParams;\n        const oauthMeta = {\n            responseType,\n            state,\n            nonce,\n            scopes,\n            clientId,\n            urls,\n            ignoreSignature,\n            redirectUri,\n            codeVerifier,\n            codeChallenge,\n            codeChallengeMethod,\n        };\n        sdk.transactionManager.save(oauthMeta, { oauth: true });\n        sdk.token.getWithRedirect._setLocation(requestUrl);\n    });\n}\n","/* eslint-disable complexity */\n/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\nimport { AuthSdkError } from '../errors';\nimport { isInteractionRequiredError, urlParamsToObject } from './util';\nimport { isString } from '../util';\nimport { handleOAuthResponse } from './handleOAuthResponse';\nfunction removeHash(sdk) {\n    var nativeHistory = sdk.token.parseFromUrl._getHistory();\n    var nativeDoc = sdk.token.parseFromUrl._getDocument();\n    var nativeLoc = sdk.token.parseFromUrl._getLocation();\n    if (nativeHistory && nativeHistory.replaceState) {\n        nativeHistory.replaceState(null, nativeDoc.title, nativeLoc.pathname + nativeLoc.search);\n    }\n    else {\n        nativeLoc.hash = '';\n    }\n}\nfunction removeSearch(sdk) {\n    var nativeHistory = sdk.token.parseFromUrl._getHistory();\n    var nativeDoc = sdk.token.parseFromUrl._getDocument();\n    var nativeLoc = sdk.token.parseFromUrl._getLocation();\n    if (nativeHistory && nativeHistory.replaceState) {\n        nativeHistory.replaceState(null, nativeDoc.title, nativeLoc.pathname + nativeLoc.hash);\n    }\n    else {\n        nativeLoc.search = '';\n    }\n}\nexport function parseFromUrl(sdk, options) {\n    options = options || {};\n    if (isString(options)) {\n        options = { url: options };\n    }\n    else {\n        options = options;\n    }\n    // https://openid.net/specs/openid-connect-core-1_0.html#Authentication\n    var defaultResponseMode = sdk.options.pkce ? 'query' : 'fragment';\n    var url = options.url;\n    var responseMode = options.responseMode || sdk.options.responseMode || defaultResponseMode;\n    var nativeLoc = sdk.token.parseFromUrl._getLocation();\n    var paramStr;\n    if (responseMode === 'query') {\n        paramStr = url ? url.substring(url.indexOf('?')) : nativeLoc.search;\n    }\n    else {\n        paramStr = url ? url.substring(url.indexOf('#')) : nativeLoc.hash;\n    }\n    if (!paramStr) {\n        return Promise.reject(new AuthSdkError('Unable to parse a token from the url'));\n    }\n    const oauthParams = sdk.transactionManager.load({\n        oauth: true,\n        pkce: sdk.options.pkce\n    });\n    const urls = oauthParams.urls;\n    delete oauthParams.urls;\n    return Promise.resolve(urlParamsToObject(paramStr))\n        .then(function (res) {\n        if (!url) {\n            // Clean hash or search from the url\n            responseMode === 'query' ? removeSearch(sdk) : removeHash(sdk);\n        }\n        return handleOAuthResponse(sdk, oauthParams, res, urls)\n            .catch(err => {\n            if (!isInteractionRequiredError(err)) {\n                sdk.transactionManager.clear();\n            }\n            throw err;\n        })\n            .then(res => {\n            sdk.transactionManager.clear();\n            return res;\n        });\n    });\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nexport default class SdkClock {\n    constructor(localOffset) {\n        // Calculated local clock offset from server time (in milliseconds). Can be positive or negative.\n        this.localOffset = parseInt(localOffset || 0);\n    }\n    // factory method. Create an instance of a clock from current context.\n    static create( /* sdk, options */) {\n        // TODO: calculate localOffset\n        var localOffset = 0;\n        return new SdkClock(localOffset);\n    }\n    // Return the current time (in seconds)\n    now() {\n        var now = (Date.now() + this.localOffset) / 1000;\n        return now;\n    }\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n *\n */\n/* global window */\n/* eslint complexity:[0,8] max-statements:[0,21] */\nimport { removeNils, warn, isObject, clone, isIE11OrLess } from './util';\nimport AuthSdkError from './errors/AuthSdkError';\nimport { TOKEN_STORAGE_NAME } from './constants';\nimport SdkClock from './clock';\nimport { isIDToken, isAccessToken, isRefreshToken } from './types';\nimport { ID_TOKEN_STORAGE_KEY, ACCESS_TOKEN_STORAGE_KEY, REFRESH_TOKEN_STORAGE_KEY } from './constants';\nconst DEFAULT_OPTIONS = {\n    autoRenew: true,\n    autoRemove: true,\n    storage: 'localStorage',\n    expireEarlySeconds: 30,\n    storageKey: TOKEN_STORAGE_NAME,\n    _storageEventDelay: 0\n};\nexport const EVENT_EXPIRED = 'expired';\nexport const EVENT_RENEWED = 'renewed';\nexport const EVENT_ADDED = 'added';\nexport const EVENT_REMOVED = 'removed';\nexport const EVENT_ERROR = 'error';\nfunction getExpireTime(tokenMgmtRef, token) {\n    var expireTime = token.expiresAt - tokenMgmtRef.options.expireEarlySeconds;\n    return expireTime;\n}\nfunction hasExpired(tokenMgmtRef, token) {\n    var expireTime = getExpireTime(tokenMgmtRef, token);\n    return expireTime <= tokenMgmtRef.clock.now();\n}\nfunction emitExpired(tokenMgmtRef, key, token) {\n    tokenMgmtRef.emitter.emit(EVENT_EXPIRED, key, token);\n}\nfunction emitRenewed(tokenMgmtRef, key, freshToken, oldToken) {\n    tokenMgmtRef.emitter.emit(EVENT_RENEWED, key, freshToken, oldToken);\n}\nfunction emitAdded(tokenMgmtRef, key, token) {\n    tokenMgmtRef.emitter.emit(EVENT_ADDED, key, token);\n}\nfunction emitRemoved(tokenMgmtRef, key, token) {\n    tokenMgmtRef.emitter.emit(EVENT_REMOVED, key, token);\n}\nfunction emitError(tokenMgmtRef, error) {\n    tokenMgmtRef.emitter.emit(EVENT_ERROR, error);\n}\nfunction emitEventsForCrossTabsStorageUpdate(tokenMgmtRef, newValue, oldValue) {\n    const oldTokens = getTokensFromStorageValue(oldValue);\n    const newTokens = getTokensFromStorageValue(newValue);\n    Object.keys(newTokens).forEach(key => {\n        const oldToken = oldTokens[key];\n        const newToken = newTokens[key];\n        if (JSON.stringify(oldToken) !== JSON.stringify(newToken)) {\n            emitAdded(tokenMgmtRef, key, newToken);\n        }\n    });\n    Object.keys(oldTokens).forEach(key => {\n        const oldToken = oldTokens[key];\n        const newToken = newTokens[key];\n        if (!newToken) {\n            emitRemoved(tokenMgmtRef, key, oldToken);\n        }\n    });\n}\nfunction clearExpireEventTimeout(tokenMgmtRef, key) {\n    clearTimeout(tokenMgmtRef.expireTimeouts[key]);\n    delete tokenMgmtRef.expireTimeouts[key];\n    // Remove the renew promise (if it exists)\n    delete tokenMgmtRef.renewPromise[key];\n}\nfunction clearExpireEventTimeoutAll(tokenMgmtRef) {\n    var expireTimeouts = tokenMgmtRef.expireTimeouts;\n    for (var key in expireTimeouts) {\n        if (!Object.prototype.hasOwnProperty.call(expireTimeouts, key)) {\n            continue;\n        }\n        clearExpireEventTimeout(tokenMgmtRef, key);\n    }\n}\nfunction setExpireEventTimeout(sdk, tokenMgmtRef, key, token) {\n    var expireTime = getExpireTime(tokenMgmtRef, token);\n    var expireEventWait = Math.max(expireTime - tokenMgmtRef.clock.now(), 0) * 1000;\n    // Clear any existing timeout\n    clearExpireEventTimeout(tokenMgmtRef, key);\n    var expireEventTimeout = setTimeout(function () {\n        emitExpired(tokenMgmtRef, key, token);\n    }, expireEventWait);\n    // Add a new timeout\n    tokenMgmtRef.expireTimeouts[key] = expireEventTimeout;\n}\nfunction setExpireEventTimeoutAll(sdk, tokenMgmtRef, storage) {\n    try {\n        var tokenStorage = storage.getStorage();\n    }\n    catch (e) {\n        // Any errors thrown on instantiation will not be caught,\n        // because there are no listeners yet\n        emitError(tokenMgmtRef, e);\n        return;\n    }\n    for (var key in tokenStorage) {\n        if (!Object.prototype.hasOwnProperty.call(tokenStorage, key)) {\n            continue;\n        }\n        var token = tokenStorage[key];\n        setExpireEventTimeout(sdk, tokenMgmtRef, key, token);\n    }\n}\n// reset timeouts to setup autoRenew for tokens from other document context (tabs)\nfunction resetExpireEventTimeoutAll(sdk, tokenMgmtRef, storage) {\n    clearExpireEventTimeoutAll(tokenMgmtRef);\n    setExpireEventTimeoutAll(sdk, tokenMgmtRef, storage);\n}\nfunction validateToken(token) {\n    if (!isObject(token) ||\n        !token.scopes ||\n        (!token.expiresAt && token.expiresAt !== 0) ||\n        (!isIDToken(token) && !isAccessToken(token) && !isRefreshToken(token))) {\n        throw new AuthSdkError('Token must be an Object with scopes, expiresAt, and one of: an idToken, accessToken, or refreshToken property');\n    }\n}\nfunction _add(sdk, tokenMgmtRef, storage, key, token) {\n    var tokenStorage = storage.getStorage();\n    validateToken(token);\n    tokenStorage[key] = token;\n    storage.setStorage(tokenStorage);\n    emitAdded(tokenMgmtRef, key, token);\n    setExpireEventTimeout(sdk, tokenMgmtRef, key, token);\n}\nfunction add(sdk, tokenMgmtRef, storage, key, token) {\n    if (sdk.features.isLocalhost()) {\n        warn('Use setTokens() instead if you want to add a set of tokens at same time.\\n' +\n            'It prevents current tab from emitting unnecessary StorageEvent,\\n' +\n            'which may cause false-positive authState change cross tabs.');\n    }\n    _add(sdk, tokenMgmtRef, storage, key, token);\n}\nfunction get(storage, key) {\n    var tokenStorage = storage.getStorage();\n    return tokenStorage[key];\n}\nfunction getKeyByType(storage, type) {\n    const tokenStorage = storage.getStorage();\n    const key = Object.keys(tokenStorage).filter(key => {\n        const token = tokenStorage[key];\n        return (isAccessToken(token) && type === 'accessToken')\n            || (isIDToken(token) && type === 'idToken')\n            || (isRefreshToken(token) && type === 'refreshToken');\n    })[0];\n    return key;\n}\nfunction getAsync(storage, key) {\n    return new Promise(function (resolve) {\n        var token = get(storage, key);\n        return resolve(token);\n    });\n}\nfunction getTokens(storage) {\n    const tokens = {};\n    const tokenStorage = storage.getStorage();\n    Object.keys(tokenStorage).forEach(key => {\n        const token = tokenStorage[key];\n        if (isAccessToken(token)) {\n            tokens.accessToken = token;\n        }\n        else if (isIDToken(token)) {\n            tokens.idToken = token;\n        }\n        else if (isRefreshToken(token)) {\n            tokens.refreshToken = token;\n        }\n    });\n    return tokens;\n}\nfunction getTokensAsync(storage) {\n    return new Promise((resolve) => {\n        const tokens = getTokens(storage);\n        return resolve(tokens);\n    });\n}\n/* eslint-disable max-params */\nfunction setTokens(sdk, tokenMgmtRef, storage, { accessToken, idToken, refreshToken }, accessTokenCb, idTokenCb, refreshTokenCb) {\n    const handleAdded = (key, token, tokenCb) => {\n        emitAdded(tokenMgmtRef, key, token);\n        setExpireEventTimeout(sdk, tokenMgmtRef, key, token);\n        if (tokenCb) {\n            tokenCb(key, token);\n        }\n    };\n    const handleRemoved = (key, token, tokenCb) => {\n        clearExpireEventTimeout(tokenMgmtRef, key);\n        emitRemoved(tokenMgmtRef, key, token);\n        if (tokenCb) {\n            tokenCb(key, token);\n        }\n    };\n    if (idToken) {\n        validateToken(idToken);\n    }\n    if (accessToken) {\n        validateToken(accessToken);\n    }\n    const idTokenKey = getKeyByType(storage, 'idToken') || ID_TOKEN_STORAGE_KEY;\n    const accessTokenKey = getKeyByType(storage, 'accessToken') || ACCESS_TOKEN_STORAGE_KEY;\n    const refreshTokenKey = getKeyByType(storage, 'refreshToken') || REFRESH_TOKEN_STORAGE_KEY;\n    // add token to storage\n    const tokenStorage = Object.assign(Object.assign(Object.assign({}, (idToken && { [idTokenKey]: idToken })), (accessToken && { [accessTokenKey]: accessToken })), (refreshToken && { [refreshTokenKey]: refreshToken }));\n    storage.setStorage(tokenStorage);\n    // emit event and start expiration timer\n    const existingTokens = getTokens(storage);\n    if (idToken) {\n        handleAdded(idTokenKey, idToken, idTokenCb);\n    }\n    else if (existingTokens.idToken) {\n        handleRemoved(idTokenKey, existingTokens.idToken, idTokenCb);\n    }\n    if (accessToken) {\n        handleAdded(accessTokenKey, accessToken, accessTokenCb);\n    }\n    else if (existingTokens.accessToken) {\n        handleRemoved(accessTokenKey, existingTokens.accessToken, accessTokenCb);\n    }\n    if (refreshToken) {\n        handleAdded(refreshTokenKey, refreshToken, refreshTokenCb);\n    }\n    else if (existingTokens.refreshToken) {\n        handleRemoved(refreshTokenKey, existingTokens.refreshToken, refreshTokenCb);\n    }\n}\n/* eslint-enable max-params */\nfunction remove(tokenMgmtRef, storage, key) {\n    // Clear any listener for this token\n    clearExpireEventTimeout(tokenMgmtRef, key);\n    var tokenStorage = storage.getStorage();\n    var removedToken = tokenStorage[key];\n    delete tokenStorage[key];\n    storage.setStorage(tokenStorage);\n    emitRemoved(tokenMgmtRef, key, removedToken);\n}\nfunction _renewToken(sdk, token) {\n    return this.getTokens()\n        .then(tokens => tokens.refreshToken)\n        .then(refreshTokenObject => {\n        if (refreshTokenObject) {\n            return sdk.token.renewTokensWithRefresh({\n                scopes: token.scopes,\n            }, refreshTokenObject)\n                .then(function (freshTokens) {\n                // Multiple tokens may have come back. Return only the token which was requested.\n                return isIDToken(token) ? freshTokens.idToken : freshTokens.accessToken;\n            });\n        }\n        else {\n            return sdk.token.renew(token);\n        }\n    });\n}\nfunction renew(sdk, tokenMgmtRef, storage, key) {\n    // Multiple callers may receive the same promise. They will all resolve or reject from the same request.\n    var existingPromise = tokenMgmtRef.renewPromise[key];\n    if (existingPromise) {\n        return existingPromise;\n    }\n    try {\n        var token = get(storage, key);\n        if (!token) {\n            throw new AuthSdkError('The tokenManager has no token for the key: ' + key);\n        }\n    }\n    catch (e) {\n        return Promise.reject(e);\n    }\n    // Remove existing autoRenew timeout\n    clearExpireEventTimeout(tokenMgmtRef, key);\n    // A refresh token means a replace instead of renewal\n    // Store the renew promise state, to avoid renewing again\n    tokenMgmtRef.renewPromise[key] = _renewToken.call(this, sdk, token)\n        .then(function (freshToken) {\n        // store and emit events for freshToken\n        const oldTokenStorage = storage.getStorage();\n        remove(tokenMgmtRef, storage, key);\n        _add(sdk, tokenMgmtRef, storage, key, freshToken);\n        emitRenewed(tokenMgmtRef, key, freshToken, oldTokenStorage[key]);\n        return freshToken;\n    })\n        .catch(function (err) {\n        if (err.name === 'OAuthError' || err.name === 'AuthSdkError') {\n            // remove expired token in storage\n            const tokenStorage = storage.getStorage();\n            const currentToken = tokenStorage[key];\n            if (currentToken && hasExpired(tokenMgmtRef, currentToken)) {\n                delete tokenStorage[key];\n                clearExpireEventTimeout(tokenMgmtRef, key);\n                storage.setStorage(tokenStorage);\n                emitRemoved(tokenMgmtRef, key, currentToken);\n            }\n            else {\n                // token have been removed from other tabs\n                // still trigger removed event for downstream listeners\n                emitRemoved(tokenMgmtRef, key);\n            }\n            err.tokenKey = key;\n            emitError(tokenMgmtRef, err);\n        }\n        throw err;\n    })\n        .finally(function () {\n        // Remove existing promise key\n        delete tokenMgmtRef.renewPromise[key];\n    });\n    return tokenMgmtRef.renewPromise[key];\n}\nfunction clear(tokenMgmtRef, storage) {\n    clearExpireEventTimeoutAll(tokenMgmtRef);\n    storage.clearStorage();\n}\nfunction shouldThrottleRenew(renewTimeQueue) {\n    let res = false;\n    renewTimeQueue.push(Date.now());\n    if (renewTimeQueue.length >= 10) {\n        // get and remove first item from queue\n        const firstTime = renewTimeQueue.shift();\n        const lastTime = renewTimeQueue[renewTimeQueue.length - 1];\n        res = lastTime - firstTime < 30 * 1000;\n    }\n    return res;\n}\nfunction getTokensFromStorageValue(value) {\n    let tokens;\n    try {\n        tokens = JSON.parse(value) || {};\n    }\n    catch (e) {\n        tokens = {};\n    }\n    return tokens;\n}\nexport class TokenManager {\n    constructor(sdk, options) {\n        options = Object.assign({}, DEFAULT_OPTIONS, removeNils(options));\n        const emitter = sdk.emitter;\n        if (!emitter) {\n            throw new AuthSdkError('Emitter should be initialized before TokenManager');\n        }\n        if (isIE11OrLess()) {\n            options._storageEventDelay = options._storageEventDelay || 1000;\n        }\n        const storageOptions = removeNils({\n            storageKey: options.storageKey,\n            secure: options.secure\n        });\n        if (typeof options.storage === 'object') {\n            // A custom storage provider must implement getItem(key) and setItem(key, val)\n            storageOptions.storageProvider = options.storage;\n        }\n        else if (options.storage) {\n            storageOptions.storageType = options.storage;\n        }\n        const storage = sdk.storageManager.getTokenStorage(storageOptions);\n        var clock = SdkClock.create( /* sdk, options */);\n        var tokenMgmtRef = {\n            clock: clock,\n            options: options,\n            emitter: emitter,\n            expireTimeouts: {},\n            renewPromise: {}\n        };\n        this.add = add.bind(this, sdk, tokenMgmtRef, storage);\n        this.get = getAsync.bind(this, storage);\n        this.remove = remove.bind(this, tokenMgmtRef, storage);\n        this.clear = clear.bind(this, tokenMgmtRef, storage);\n        this.renew = renew.bind(this, sdk, tokenMgmtRef, storage);\n        this.on = tokenMgmtRef.emitter.on.bind(tokenMgmtRef.emitter);\n        this.off = tokenMgmtRef.emitter.off.bind(tokenMgmtRef.emitter);\n        this.hasExpired = hasExpired.bind(this, tokenMgmtRef);\n        this.getTokens = getTokensAsync.bind(this, storage);\n        this.setTokens = setTokens.bind(this, sdk, tokenMgmtRef, storage);\n        this._getStorageKeyByType = getKeyByType.bind(this, storage);\n        this._clearExpireEventTimeoutAll = clearExpireEventTimeoutAll.bind(this, tokenMgmtRef);\n        this._getOptions = () => clone(options);\n        this._resetExpireEventTimeoutAll = resetExpireEventTimeoutAll.bind(this, sdk, tokenMgmtRef, storage);\n        this._emitEventsForCrossTabsStorageUpdate = emitEventsForCrossTabsStorageUpdate.bind(this, tokenMgmtRef);\n        const renewTimeQueue = [];\n        const onTokenExpiredHandler = (key) => {\n            if (options.autoRenew) {\n                if (shouldThrottleRenew(renewTimeQueue)) {\n                    const error = new AuthSdkError('Too many token renew requests');\n                    emitError(tokenMgmtRef, error);\n                }\n                else {\n                    this.renew(key).catch(() => { }); // Renew errors will emit an \"error\" event \n                }\n            }\n            else if (options.autoRemove) {\n                this.remove(key);\n            }\n        };\n        this.on(EVENT_EXPIRED, onTokenExpiredHandler);\n        setExpireEventTimeoutAll(sdk, tokenMgmtRef, storage);\n        // Sync authState cross multiple tabs when localStorage is used as the storageProvider\n        // A StorageEvent is sent to a window when a storage area it has access to is changed \n        // within the context of another document.\n        // https://developer.mozilla.org/en-US/docs/Web/API/StorageEvent\n        window.addEventListener('storage', ({ key, newValue, oldValue }) => {\n            const handleCrossTabsStorageChange = () => {\n                this._resetExpireEventTimeoutAll();\n                this._emitEventsForCrossTabsStorageUpdate(newValue, oldValue);\n            };\n            // Skip if:\n            // not from localStorage.clear (event.key is null)\n            // event.key is not the storageKey\n            // oldValue === newValue\n            if (key && (key !== options.storageKey || newValue === oldValue)) {\n                return;\n            }\n            // LocalStorage cross tabs update is not synced in IE, set a 1s timer by default to read latest value\n            // https://stackoverflow.com/questions/24077117/localstorage-in-win8-1-ie11-does-not-synchronize\n            setTimeout(() => handleCrossTabsStorageChange(), options._storageEventDelay);\n        });\n    }\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n// Implements a queue for synchronous or asynchronous methods\n// Methods will be wrapped in a promise and execute sequentially\n// This can be used to prevent concurrent calls to a single method or a set of methods\nimport { isPromise } from './util';\nclass PromiseQueue {\n    constructor() {\n        this.queue = [];\n        this.running = false;\n    }\n    // Returns a promise\n    // If the method is synchronous, it will resolve when the method completes\n    // If the method returns a promise, it will resolve (or reject) with the value from the method's promise\n    push(method, thisObject, ...args) {\n        return new Promise((resolve, reject) => {\n            this.queue.push({\n                method,\n                thisObject,\n                args,\n                resolve,\n                reject\n            });\n            this.run();\n        });\n    }\n    run() {\n        if (this.running) {\n            return;\n        }\n        if (this.queue.length === 0) {\n            return;\n        }\n        this.running = true;\n        var queueItem = this.queue.shift();\n        var res = queueItem.method.apply(queueItem.thisObject, queueItem.args);\n        if (isPromise(res)) {\n            res.then(queueItem.resolve, queueItem.reject).finally(() => {\n                this.running = false;\n                this.run();\n            });\n        }\n        else {\n            queueItem.resolve(res);\n            this.running = false;\n            this.run();\n        }\n    }\n}\nexport default PromiseQueue;\n","import { AuthSdkError } from '../errors';\nimport { isFingerprintSupported } from './features';\nimport { addListener, removeListener } from '../oidc';\nexport default function fingerprint(sdk, options) {\n    options = options || {};\n    if (!isFingerprintSupported()) {\n        return Promise.reject(new AuthSdkError('Fingerprinting is not supported on this device'));\n    }\n    var timeout;\n    var iframe;\n    var listener;\n    var promise = new Promise(function (resolve, reject) {\n        iframe = document.createElement('iframe');\n        iframe.style.display = 'none';\n        // eslint-disable-next-line complexity\n        listener = function listener(e) {\n            if (!e || !e.data || e.origin !== sdk.getIssuerOrigin()) {\n                return;\n            }\n            try {\n                var msg = JSON.parse(e.data);\n            }\n            catch (err) {\n                // iframe messages should all be parsable\n                // skip not parsable messages come from other sources in same origin (browser extensions)\n                // TODO: add namespace flag in okta-core to distinguish messages that come from other sources\n                return;\n            }\n            if (!msg) {\n                return;\n            }\n            if (msg.type === 'FingerprintAvailable') {\n                return resolve(msg.fingerprint);\n            }\n            if (msg.type === 'FingerprintServiceReady') {\n                e.source.postMessage(JSON.stringify({\n                    type: 'GetFingerprint'\n                }), e.origin);\n            }\n        };\n        addListener(window, 'message', listener);\n        iframe.src = sdk.getIssuerOrigin() + '/auth/services/devicefingerprint';\n        document.body.appendChild(iframe);\n        timeout = setTimeout(function () {\n            reject(new AuthSdkError('Fingerprinting timed out'));\n        }, options.timeout || 15000);\n    });\n    return promise.finally(function () {\n        clearTimeout(timeout);\n        removeListener(window, 'message', listener);\n        if (document.body.contains(iframe)) {\n            iframe.parentElement.removeChild(iframe);\n        }\n    });\n}\n","import { AuthSdkError } from './errors';\nimport { getConsole, warn } from './util';\nimport { EVENT_ADDED, EVENT_REMOVED } from './TokenManager';\nconst PCancelable = require('p-cancelable');\nexport const DEFAULT_AUTH_STATE = {\n    isPending: true,\n    isAuthenticated: false,\n    idToken: null,\n    accessToken: null,\n    refreshToken: null,\n};\nconst DEFAULT_PENDING = {\n    updateAuthStatePromise: null,\n    canceledTimes: 0\n};\nconst EVENT_AUTH_STATE_CHANGE = 'authStateChange';\nconst MAX_PROMISE_CANCEL_TIMES = 10;\n// only compare first level of authState\nconst isSameAuthState = (prevState, state) => {\n    return prevState.isPending === state.isPending\n        && prevState.isAuthenticated === state.isAuthenticated\n        && JSON.stringify(prevState.idToken) === JSON.stringify(state.idToken)\n        && JSON.stringify(prevState.accessToken) === JSON.stringify(state.accessToken)\n        && prevState.error === state.error;\n};\nexport class AuthStateManager {\n    constructor(sdk) {\n        if (!sdk.emitter) {\n            throw new AuthSdkError('Emitter should be initialized before AuthStateManager');\n        }\n        this._sdk = sdk;\n        this._pending = Object.assign({}, DEFAULT_PENDING);\n        this._authState = Object.assign({}, DEFAULT_AUTH_STATE);\n        this._logOptions = {};\n        // Listen on tokenManager events to start updateState process\n        // \"added\" event is emitted in both add and renew process\n        // Only listen on \"added\" event to update auth state\n        sdk.tokenManager.on(EVENT_ADDED, (key, token) => {\n            this._setLogOptions({ event: EVENT_ADDED, key, token });\n            this.updateAuthState();\n        });\n        sdk.tokenManager.on(EVENT_REMOVED, (key, token) => {\n            this._setLogOptions({ event: EVENT_REMOVED, key, token });\n            this.updateAuthState();\n        });\n    }\n    _setLogOptions(options) {\n        this._logOptions = options;\n    }\n    getAuthState() {\n        return this._authState;\n    }\n    updateAuthState() {\n        if (!this._sdk.emitter.e\n            || !this._sdk.emitter.e[EVENT_AUTH_STATE_CHANGE]\n            || !this._sdk.emitter.e[EVENT_AUTH_STATE_CHANGE].length) {\n            warn('updateAuthState is an asynchronous method with no return, ' +\n                'please subscribe to the latest authState update with ' +\n                'authStateManager.subscribe(handler) method before calling updateAuthState.');\n        }\n        const { transformAuthState, devMode } = this._sdk.options;\n        const { autoRenew, autoRemove } = this._sdk.tokenManager._getOptions();\n        const log = (status) => {\n            const { event, key, token } = this._logOptions;\n            getConsole().group(`OKTA-AUTH-JS:updateAuthState: Event:${event} Status:${status}`);\n            getConsole().log(key, token);\n            getConsole().log('Current authState', this._authState);\n            getConsole().groupEnd();\n            // clear log options after logging\n            this._logOptions = {};\n        };\n        const emitAuthStateChange = (authState) => {\n            if (isSameAuthState(this._authState, authState)) {\n                devMode && log('unchanged');\n                return;\n            }\n            this._authState = authState;\n            // emit new authState object\n            this._sdk.emitter.emit(EVENT_AUTH_STATE_CHANGE, Object.assign({}, authState));\n            devMode && log('emitted');\n        };\n        const shouldEvaluateIsPending = () => (autoRenew || autoRemove);\n        if (this._pending.updateAuthStatePromise) {\n            if (this._pending.canceledTimes >= MAX_PROMISE_CANCEL_TIMES) {\n                // stop canceling then starting a new promise\n                // let existing promise finish to prevent running into loops\n                devMode && log('terminated');\n                return;\n            }\n            else {\n                this._pending.updateAuthStatePromise.cancel();\n            }\n        }\n        /* eslint-disable complexity */\n        const cancelablePromise = new PCancelable((resolve, _, onCancel) => {\n            onCancel.shouldReject = false;\n            onCancel(() => {\n                this._pending.updateAuthStatePromise = null;\n                this._pending.canceledTimes = this._pending.canceledTimes + 1;\n                devMode && log('canceled');\n            });\n            const emitAndResolve = (authState) => {\n                if (cancelablePromise.isCanceled) {\n                    resolve();\n                    return;\n                }\n                // emit event and clear pending states\n                emitAuthStateChange(authState);\n                this._pending = Object.assign({}, DEFAULT_PENDING);\n                resolve();\n            };\n            this._sdk.tokenManager.getTokens()\n                .then(({ accessToken, idToken, refreshToken }) => {\n                if (cancelablePromise.isCanceled) {\n                    resolve();\n                    return;\n                }\n                // evaluate isPending if any token is expired\n                // then wait for next renewed event to evaluate a new state with valid tokens\n                // isPending state should only apply to token driven evaluation\n                let isPending = false;\n                if (accessToken && this._sdk.tokenManager.hasExpired(accessToken)) {\n                    isPending = shouldEvaluateIsPending();\n                    // if autoRenew is pending, continue to use the expired token while renew is in process\n                    if (!isPending) {\n                        accessToken = null;\n                    }\n                }\n                if (idToken && this._sdk.tokenManager.hasExpired(idToken)) {\n                    isPending = shouldEvaluateIsPending();\n                    // if autoRenew is pending, continue to use the expired token while renew is in process\n                    if (!isPending) {\n                        idToken = null;\n                    }\n                }\n                const authState = {\n                    accessToken,\n                    idToken,\n                    refreshToken,\n                    isPending,\n                    isAuthenticated: !!(accessToken && idToken)\n                };\n                const promise = transformAuthState\n                    ? transformAuthState(this._sdk, authState)\n                    : Promise.resolve(authState);\n                promise\n                    .then(authState => emitAndResolve(authState))\n                    .catch(error => emitAndResolve({\n                    accessToken,\n                    idToken,\n                    refreshToken,\n                    isAuthenticated: false,\n                    isPending: false,\n                    error\n                }));\n            });\n        });\n        /* eslint-enable complexity */\n        this._pending.updateAuthStatePromise = cancelablePromise;\n    }\n    subscribe(handler) {\n        this._sdk.emitter.on(EVENT_AUTH_STATE_CHANGE, handler);\n    }\n    unsubscribe(handler) {\n        this._sdk.emitter.off(EVENT_AUTH_STATE_CHANGE, handler);\n    }\n}\n","/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n/* eslint-disable complexity */\n/* eslint-disable max-statements */\n/* SDK_VERSION is defined in webpack config */\n/* global SDK_VERSION */\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport OktaAuthBase from '../OktaAuthBase';\nimport * as features from './features';\nimport fetchRequest from '../fetch/fetchRequest';\nimport browserStorage from './browserStorage';\nimport { toQueryString, toAbsoluteUrl, clone, warn, deprecate } from '../util';\nimport { getUserAgent } from '../builderUtil';\nimport { DEFAULT_MAX_CLOCK_SKEW, REFERRER_PATH_STORAGE_KEY } from '../constants';\nimport * as constants from '../constants';\nimport { closeSession, sessionExists, getSession, refreshSession, setCookieAndRedirect } from '../session';\nimport { getOAuthUrls, getWithoutPrompt, getWithPopup, getWithRedirect, isLoginRedirect, parseFromUrl, decodeToken, revokeToken, renewToken, renewTokens, renewTokensWithRefresh, getUserInfo, verifyToken, prepareTokenParams, exchangeCodeForTokens, isInteractionRequiredError, isInteractionRequired, } from '../oidc';\nimport { TokenManager } from '../TokenManager';\nimport http from '../http';\nimport PromiseQueue from '../PromiseQueue';\nimport fingerprint from './fingerprint';\nimport { postToTransaction } from '../tx';\nimport { AuthStateManager } from '../AuthStateManager';\nconst Emitter = require('tiny-emitter');\nfunction getCookieSettings(args = {}, isHTTPS) {\n    // Secure cookies will be automatically used on a HTTPS connection\n    // Non-secure cookies will be automatically used on a HTTP connection\n    // secure option can override the automatic behavior\n    var cookieSettings = args.cookies || {};\n    if (typeof cookieSettings.secure === 'undefined') {\n        cookieSettings.secure = isHTTPS;\n    }\n    if (typeof cookieSettings.sameSite === 'undefined') {\n        cookieSettings.sameSite = cookieSettings.secure ? 'none' : 'lax';\n    }\n    // If secure=true, but the connection is not HTTPS, set secure=false.\n    if (cookieSettings.secure && !isHTTPS) {\n        // eslint-disable-next-line no-console\n        warn('The current page is not being served with the HTTPS protocol.\\n' +\n            'For security reasons, we strongly recommend using HTTPS.\\n' +\n            'If you cannot use HTTPS, set \"cookies.secure\" option to false.');\n        cookieSettings.secure = false;\n    }\n    // Chrome >= 80 will block cookies with SameSite=None unless they are also Secure\n    // If sameSite=none, but the connection is not HTTPS, set sameSite=lax.\n    if (cookieSettings.sameSite === 'none' && !cookieSettings.secure) {\n        cookieSettings.sameSite = 'lax';\n    }\n    return cookieSettings;\n}\nclass OktaAuthBrowser extends OktaAuthBase {\n    constructor(args = {}) {\n        super(Object.assign({\n            httpRequestClient: fetchRequest,\n            storageUtil: args.storageUtil || browserStorage,\n            cookies: getCookieSettings(args, OktaAuthBrowser.features.isHTTPS()),\n            storageManager: Object.assign({\n                token: {\n                    storageTypes: [\n                        'localStorage',\n                        'sessionStorage',\n                        'cookie'\n                    ],\n                    useMultipleCookies: true\n                },\n                cache: {\n                    storageTypes: [\n                        'localStorage',\n                        'sessionStorage',\n                        'cookie'\n                    ]\n                },\n                transaction: {\n                    storageTypes: [\n                        'sessionStorage',\n                        'localStorage',\n                        'cookie'\n                    ]\n                }\n            }, args.storageManager)\n        }, args));\n        // Add shims for compatibility, these will be removed in next major version. OKTA-362589\n        Object.assign(this.options.storageUtil, {\n            getPKCEStorage: this.storageManager.getLegacyPKCEStorage.bind(this.storageManager),\n            getHttpCache: this.storageManager.getHttpCache.bind(this.storageManager),\n        });\n        this._pending = { handleLogin: false };\n        this.options = Object.assign(this.options, {\n            pkce: args.pkce === false ? false : true,\n            redirectUri: toAbsoluteUrl(args.redirectUri, window.location.origin), // allow relative URIs\n        });\n        this.userAgent = getUserAgent(args, `okta-auth-js/${SDK_VERSION}`);\n        // Digital clocks will drift over time, so the server\n        // can misalign with the time reported by the browser.\n        // The maxClockSkew allows relaxing the time-based\n        // validation of tokens (in seconds, not milliseconds).\n        // It currently defaults to 300, because 5 min is the\n        // default maximum tolerance allowed by Kerberos.\n        // (https://technet.microsoft.com/en-us/library/cc976357.aspx)\n        if (!args.maxClockSkew && args.maxClockSkew !== 0) {\n            this.options.maxClockSkew = DEFAULT_MAX_CLOCK_SKEW;\n        }\n        else {\n            this.options.maxClockSkew = args.maxClockSkew;\n        }\n        this.session = {\n            close: closeSession.bind(null, this),\n            exists: sessionExists.bind(null, this),\n            get: getSession.bind(null, this),\n            refresh: refreshSession.bind(null, this),\n            setCookieAndRedirect: setCookieAndRedirect.bind(null, this)\n        };\n        this._tokenQueue = new PromiseQueue();\n        this.token = {\n            prepareTokenParams: prepareTokenParams.bind(null, this),\n            exchangeCodeForTokens: exchangeCodeForTokens.bind(null, this),\n            getWithoutPrompt: getWithoutPrompt.bind(null, this),\n            getWithPopup: getWithPopup.bind(null, this),\n            getWithRedirect: getWithRedirect.bind(null, this),\n            parseFromUrl: parseFromUrl.bind(null, this),\n            decode: decodeToken,\n            revoke: revokeToken.bind(null, this),\n            renew: renewToken.bind(null, this),\n            renewTokensWithRefresh: renewTokensWithRefresh.bind(null, this),\n            renewTokens: renewTokens.bind(null, this),\n            getUserInfo: getUserInfo.bind(null, this),\n            verify: verifyToken.bind(null, this),\n            isLoginRedirect: isLoginRedirect.bind(null, this)\n        };\n        // Wrap all async token API methods using MethodQueue to avoid issues with concurrency\n        const syncMethods = ['decode', 'isLoginRedirect'];\n        Object.keys(this.token).forEach(key => {\n            if (syncMethods.indexOf(key) >= 0) { // sync methods should not be wrapped\n                return;\n            }\n            var method = this.token[key];\n            this.token[key] = PromiseQueue.prototype.push.bind(this._tokenQueue, method, null);\n        });\n        Object.assign(this.token.getWithRedirect, {\n            // This is exposed so we can set window.location in our tests\n            _setLocation: function (url) {\n                window.location = url;\n            }\n        });\n        Object.assign(this.token.parseFromUrl, {\n            // This is exposed so we can mock getting window.history in our tests\n            _getHistory: function () {\n                return window.history;\n            },\n            // This is exposed so we can mock getting window.location in our tests\n            _getLocation: function () {\n                return window.location;\n            },\n            // This is exposed so we can mock getting window.document in our tests\n            _getDocument: function () {\n                return window.document;\n            }\n        });\n        // Fingerprint API\n        this.fingerprint = fingerprint.bind(null, this);\n        this.emitter = new Emitter();\n        this.tokenManager = new TokenManager(this, args.tokenManager);\n        this.authStateManager = new AuthStateManager(this);\n    }\n    // ES6 module users can use named exports to access all symbols\n    // CommonJS module users (CDN) need all exports on this object\n    // Utility methods for interaction code flow\n    isInteractionRequired() {\n        return isInteractionRequired(this);\n    }\n    isInteractionRequiredError(error) {\n        return isInteractionRequiredError(error);\n    }\n    /**\n     * Alias method of signInWithCredentials\n     *\n     * @todo This method is deprecated. Remove it in 5.0\n     */\n    signIn(opts) {\n        if (this.features.isLocalhost()) {\n            deprecate('This method has been deprecated, please use signInWithCredentials() instead.');\n        }\n        return this.signInWithCredentials(opts);\n    }\n    signInWithCredentials(opts) {\n        opts = clone(opts || {});\n        const _postToTransaction = (options) => {\n            delete opts.sendFingerprint;\n            return postToTransaction(this, '/api/v1/authn', opts, options);\n        };\n        if (!opts.sendFingerprint) {\n            return _postToTransaction();\n        }\n        return this.fingerprint()\n            .then(function (fingerprint) {\n            return _postToTransaction({\n                headers: {\n                    'X-Device-Fingerprint': fingerprint\n                }\n            });\n        });\n    }\n    signInWithRedirect(opts = {}) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { originalUri } = opts, additionalParams = __rest(opts, [\"originalUri\"]);\n            if (this._pending.handleLogin) {\n                // Don't trigger second round\n                return;\n            }\n            this._pending.handleLogin = true;\n            try {\n                // Trigger default signIn redirect flow\n                if (originalUri) {\n                    this.setOriginalUri(originalUri);\n                }\n                const params = Object.assign({\n                    // TODO: remove this line when default scopes are changed OKTA-343294\n                    scopes: this.options.scopes || ['openid', 'email', 'profile']\n                }, additionalParams);\n                yield this.token.getWithRedirect(params);\n            }\n            finally {\n                this._pending.handleLogin = false;\n            }\n        });\n    }\n    // Ends the current Okta SSO session without redirecting to Okta.\n    closeSession() {\n        // Clear all local tokens\n        this.tokenManager.clear();\n        return this.session.close() // DELETE /api/v1/sessions/me\n            .catch(function (e) {\n            if (e.name === 'AuthApiError' && e.errorCode === 'E0000007') {\n                // Session does not exist or has already been closed\n                return null;\n            }\n            throw e;\n        });\n    }\n    // Revokes the access token for the application session\n    revokeAccessToken(accessToken) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!accessToken) {\n                accessToken = (yield this.tokenManager.getTokens()).accessToken;\n                const accessTokenKey = this.tokenManager._getStorageKeyByType('accessToken');\n                this.tokenManager.remove(accessTokenKey);\n            }\n            // Access token may have been removed. In this case, we will silently succeed.\n            if (!accessToken) {\n                return Promise.resolve(null);\n            }\n            return this.token.revoke(accessToken);\n        });\n    }\n    // Revokes the refresh token for the application session\n    revokeRefreshToken(refreshToken) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!refreshToken) {\n                refreshToken = (yield this.tokenManager.getTokens()).refreshToken;\n                const refreshTokenKey = this.tokenManager._getStorageKeyByType('refreshToken');\n                this.tokenManager.remove(refreshTokenKey);\n            }\n            // Refresh token may have been removed. In this case, we will silently succeed.\n            if (!refreshToken) {\n                return Promise.resolve(null);\n            }\n            return this.token.revoke(refreshToken);\n        });\n    }\n    // Revokes refreshToken or accessToken, clears all local tokens, then redirects to Okta to end the SSO session.\n    signOut(options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            options = Object.assign({}, options);\n            // postLogoutRedirectUri must be whitelisted in Okta Admin UI\n            var defaultUri = window.location.origin;\n            var currentUri = window.location.href;\n            var postLogoutRedirectUri = options.postLogoutRedirectUri\n                || this.options.postLogoutRedirectUri\n                || defaultUri;\n            var accessToken = options.accessToken;\n            var refreshToken = options.refreshToken;\n            var revokeAccessToken = options.revokeAccessToken !== false;\n            var revokeRefreshToken = options.revokeRefreshToken !== false;\n            var idToken = options.idToken;\n            var logoutUrl = getOAuthUrls(this).logoutUrl;\n            if (typeof idToken === 'undefined') {\n                idToken = (yield this.tokenManager.getTokens()).idToken;\n            }\n            if (revokeRefreshToken && typeof refreshToken === 'undefined') {\n                refreshToken = (yield this.tokenManager.getTokens()).refreshToken;\n            }\n            if (revokeAccessToken && typeof accessToken === 'undefined') {\n                accessToken = (yield this.tokenManager.getTokens()).accessToken;\n            }\n            // Clear all local tokens\n            this.tokenManager.clear();\n            if (revokeRefreshToken && refreshToken) {\n                yield this.revokeRefreshToken(refreshToken);\n            }\n            if (revokeAccessToken && accessToken) {\n                yield this.revokeAccessToken(accessToken);\n            }\n            // No idToken? This can happen if the storage was cleared.\n            // Fallback to XHR signOut, then simulate a redirect to the post logout uri\n            if (!idToken) {\n                return this.closeSession() // can throw if the user cannot be signed out\n                    .then(function () {\n                    if (postLogoutRedirectUri === currentUri) {\n                        window.location.reload(); // force a hard reload if URI is not changing\n                    }\n                    else {\n                        window.location.assign(postLogoutRedirectUri);\n                    }\n                });\n            }\n            // logout redirect using the idToken.\n            var state = options.state;\n            var idTokenHint = idToken.idToken; // a string\n            var logoutUri = logoutUrl + '?id_token_hint=' + encodeURIComponent(idTokenHint) +\n                '&post_logout_redirect_uri=' + encodeURIComponent(postLogoutRedirectUri);\n            // State allows option parameters to be passed to logout redirect uri\n            if (state) {\n                logoutUri += '&state=' + encodeURIComponent(state);\n            }\n            window.location.assign(logoutUri);\n        });\n    }\n    webfinger(opts) {\n        var url = '/.well-known/webfinger' + toQueryString(opts);\n        var options = {\n            headers: {\n                'Accept': 'application/jrd+json'\n            }\n        };\n        return http.get(this, url, options);\n    }\n    //\n    // Common Methods from downstream SDKs\n    //\n    isAuthenticated(timeout) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const authState = this.authStateManager.getAuthState();\n            if (!authState.isPending) {\n                return Promise.resolve(authState.isAuthenticated);\n            }\n            let clear, handler, timeoutId;\n            return new Promise(resolve => {\n                clear = () => {\n                    this.authStateManager.unsubscribe(handler);\n                    clearTimeout(timeoutId);\n                };\n                handler = ({ isAuthenticated, isPending }) => {\n                    if (!isPending) {\n                        resolve(isAuthenticated);\n                        clear();\n                    }\n                };\n                timeoutId = setTimeout(() => {\n                    resolve(false);\n                    clear();\n                }, timeout || 60 * 1000);\n                this.authStateManager.subscribe(handler);\n                this.authStateManager.updateAuthState();\n            });\n        });\n    }\n    getUser() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { idToken, accessToken } = this.authStateManager.getAuthState();\n            return this.token.getUserInfo(accessToken, idToken);\n        });\n    }\n    getIdToken() {\n        const { idToken } = this.authStateManager.getAuthState();\n        return idToken ? idToken.idToken : undefined;\n    }\n    getAccessToken() {\n        const { accessToken } = this.authStateManager.getAuthState();\n        return accessToken ? accessToken.accessToken : undefined;\n    }\n    getRefreshToken() {\n        const { refreshToken } = this.authStateManager.getAuthState();\n        return refreshToken ? refreshToken.refreshToken : undefined;\n    }\n    /**\n     * Store parsed tokens from redirect url\n     */\n    storeTokensFromRedirect() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { tokens } = yield this.token.parseFromUrl();\n            this.tokenManager.setTokens(tokens);\n        });\n    }\n    setOriginalUri(originalUri) {\n        // Use current location if originalUri was not passed\n        originalUri = originalUri || window.location.href;\n        // Store originalUri\n        const storage = browserStorage.getSessionStorage();\n        storage.setItem(REFERRER_PATH_STORAGE_KEY, originalUri);\n    }\n    getOriginalUri() {\n        const storage = browserStorage.getSessionStorage();\n        const originalUri = storage.getItem(REFERRER_PATH_STORAGE_KEY) || window.location.origin;\n        return originalUri;\n    }\n    removeOriginalUri() {\n        const storage = browserStorage.getSessionStorage();\n        storage.removeItem(REFERRER_PATH_STORAGE_KEY);\n    }\n    isLoginRedirect() {\n        return isLoginRedirect(this);\n    }\n    handleLoginRedirect(tokens) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const handleRedirect = ({ isPending }) => __awaiter(this, void 0, void 0, function* () {\n                if (isPending) {\n                    return;\n                }\n                // Unsubscribe listener\n                this.authStateManager.unsubscribe(handleRedirect);\n                // Get and clear originalUri from storage\n                const originalUri = this.getOriginalUri();\n                this.removeOriginalUri();\n                // Redirect to originalUri\n                const { restoreOriginalUri } = this.options;\n                if (restoreOriginalUri) {\n                    yield restoreOriginalUri(this, originalUri);\n                }\n                else {\n                    window.location.replace(originalUri);\n                }\n            });\n            // Handle redirect after authState is updated \n            this.authStateManager.subscribe(handleRedirect);\n            // Store tokens and update AuthState by the emitted events\n            if (tokens) {\n                this.tokenManager.setTokens(tokens);\n            }\n            else if (this.isLoginRedirect()) {\n                try {\n                    yield this.storeTokensFromRedirect();\n                }\n                catch (e) {\n                    this.authStateManager.unsubscribe(handleRedirect);\n                    throw e;\n                }\n            }\n            else {\n                this.authStateManager.unsubscribe(handleRedirect);\n            }\n        });\n    }\n    isPKCE() {\n        return !!this.options.pkce;\n    }\n    hasResponseType(responseType) {\n        let hasResponseType = false;\n        if (Array.isArray(this.options.responseType) && this.options.responseType.length) {\n            hasResponseType = this.options.responseType.indexOf(responseType) >= 0;\n        }\n        else {\n            hasResponseType = this.options.responseType === responseType;\n        }\n        return hasResponseType;\n    }\n    isAuthorizationCodeFlow() {\n        return this.hasResponseType('code');\n    }\n}\n// Hoist feature detection functions to static type\nOktaAuthBrowser.features = OktaAuthBrowser.prototype.features = features;\n// Also hoist values and utility functions for CommonJS users\nObject.assign(OktaAuthBrowser, {\n    constants,\n    isInteractionRequiredError\n});\nexport default OktaAuthBrowser;\n"],"sourceRoot":""}